<html>
<head>
	<title>Direct Connect Protocol Documentation</title>
	<link rel=stylesheet href="/web/20040225141306cs_/http://wza.digitalbrains.com/DC/doc/screen.css" type="text/css" media=screen>
</head>

<body>
<!-- BEGIN WAYBACK TOOLBAR INSERT -->

<script type="text/javascript" src="/static/js/disclaim-element.js" ></script>
<script type="text/javascript" src="/static/js/graph-calc.js" ></script>
<script type="text/javascript" src="/static/jflot/jquery.min.js" ></script>
<script type="text/javascript">
//<![CDATA[
var firstDate = 820454400000;
var lastDate = 1388534399999;
var wbPrefix = "/web/";
var wbCurrentUrl = "http:\/\/wza.digitalbrains.com\/DC\/doc\/Command_Types_(client_to_client).html";

var curYear = -1;
var curMonth = -1;
var yearCount = 18;
var firstYear = 1996;
var imgWidth = 450;
var yearImgWidth = 25;
var monthImgWidth = 2;
var trackerVal = "none";
var displayDay = "25";
var displayMonth = "Feb";
var displayYear = "2004";
var prettyMonths = ["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];

function showTrackers(val) {
	if(val == trackerVal) {
		return;
	}
	if(val == "inline") {
		document.getElementById("displayYearEl").style.color = "#ec008c";
		document.getElementById("displayMonthEl").style.color = "#ec008c";
		document.getElementById("displayDayEl").style.color = "#ec008c";		
	} else {
		document.getElementById("displayYearEl").innerHTML = displayYear;
		document.getElementById("displayYearEl").style.color = "#ff0";
		document.getElementById("displayMonthEl").innerHTML = displayMonth;
		document.getElementById("displayMonthEl").style.color = "#ff0";
		document.getElementById("displayDayEl").innerHTML = displayDay;
		document.getElementById("displayDayEl").style.color = "#ff0";
	}
   document.getElementById("wbMouseTrackYearImg").style.display = val;
   document.getElementById("wbMouseTrackMonthImg").style.display = val;
   trackerVal = val;
}
function getElementX2(obj) {
	var thing = jQuery(obj);
	if((thing == undefined) 
			|| (typeof thing == "undefined") 
			|| (typeof thing.offset == "undefined")) {
		return getElementX(obj);
	}
	return Math.round(thing.offset().left);
}
function trackMouseMove(event,element) {

   var eventX = getEventX(event);
   var elementX = getElementX2(element);
   var xOff = eventX - elementX;
	if(xOff < 0) {
		xOff = 0;
	} else if(xOff > imgWidth) {
		xOff = imgWidth;
	}
   var monthOff = xOff % yearImgWidth;

   var year = Math.floor(xOff / yearImgWidth);
	var yearStart = year * yearImgWidth;
   var monthOfYear = Math.floor(monthOff / monthImgWidth);
   if(monthOfYear > 11) {
       monthOfYear = 11;
   }
   // 1 extra border pixel at the left edge of the year:
   var month = (year * 12) + monthOfYear;
   var day = 1;
	if(monthOff % 2 == 1) {
		day = 15;
	}
	var dateString = 
		zeroPad(year + firstYear) + 
		zeroPad(monthOfYear+1,2) +
		zeroPad(day,2) + "000000";

	var monthString = prettyMonths[monthOfYear];
	document.getElementById("displayYearEl").innerHTML = year + 1996;
	document.getElementById("displayMonthEl").innerHTML = monthString;
	// looks too jarring when it changes..
	//document.getElementById("displayDayEl").innerHTML = zeroPad(day,2);

	var url = wbPrefix + dateString + '/' +  wbCurrentUrl;
	document.getElementById('wm-graph-anchor').href = url;

   //document.getElementById("wmtbURL").value="evX("+eventX+") elX("+elementX+") xO("+xOff+") y("+year+") m("+month+") monthOff("+monthOff+") DS("+dateString+") Moy("+monthOfYear+") ms("+monthString+")";
   if(curYear != year) {
       var yrOff = year * yearImgWidth;
       document.getElementById("wbMouseTrackYearImg").style.left = yrOff + "px";
       curYear = year;
   }
   if(curMonth != month) {
       var mtOff = year + (month * monthImgWidth) + 1;
       document.getElementById("wbMouseTrackMonthImg").style.left = mtOff + "px";
       curMonth = month;
   }
}
//]]>
</script>

<style type="text/css">body{margin-top:0!important;padding-top:0!important;min-width:800px!important;}#wm-ipp a:hover{text-decoration:underline!important;}</style>
<div id="wm-ipp" style="display:none; position:relative;padding:0 5px;min-height:70px;min-width:800px; z-index:9000;">
<div id="wm-ipp-inside" style="position:fixed;padding:0!important;margin:0!important;width:97%;min-width:780px;border:5px solid #000;border-top:none;background-image:url(/static/images/toolbar/wm_tb_bk_trns.png);text-align:center;-moz-box-shadow:1px 1px 3px #333;-webkit-box-shadow:1px 1px 3px #333;box-shadow:1px 1px 3px #333;font-size:11px!important;font-family:'Lucida Grande','Arial',sans-serif!important;">
   <table style="border-collapse:collapse;margin:0;padding:0;width:100%;"><tbody><tr>
   <td style="padding:10px;vertical-align:top;min-width:110px;">
   <a href="/web/" title="Wayback Machine home page" style="background-color:transparent;border:none;"><img src="/static/images/toolbar/wayback-toolbar-logo.png" alt="Wayback Machine" width="110" height="39" border="0"/></a>
   </td>
   <td style="padding:0!important;text-align:center;vertical-align:top;width:100%;">

       <table style="border-collapse:collapse;margin:0 auto;padding:0;width:570px;"><tbody><tr>
       <td style="padding:3px 0;" colspan="2">
       <form target="_top" method="get" action="/web/form-submit.jsp" name="wmtb" id="wmtb" style="margin:0!important;padding:0!important;"><input type="text" name="url" id="wmtbURL" value="http://wza.digitalbrains.com/DC/doc/Command_Types_(client_to_client).html" style="width:400px;font-size:11px;font-family:'Lucida Grande','Arial',sans-serif;" onfocus="javascript:this.focus();this.select();" /><input type="hidden" name="type" value="replay" /><input type="hidden" name="date" value="20040225141306" /><input type="submit" value="Go" style="font-size:11px;font-family:'Lucida Grande','Arial',sans-serif;margin-left:5px;" /><span id="wm_tb_options" style="display:block;"></span></form>
       </td>
       <td style="vertical-align:bottom;padding:5px 0 0 0!important;" rowspan="2">
           <table style="border-collapse:collapse;width:110px;color:#99a;font-family:'Helvetica','Lucida Grande','Arial',sans-serif;"><tbody>
			
           <!-- NEXT/PREV MONTH NAV AND MONTH INDICATOR -->
           <tr style="width:110px;height:16px;font-size:10px!important;">
           	<td style="padding-right:9px;font-size:11px!important;font-weight:bold;text-transform:uppercase;text-align:right;white-space:nowrap;overflow:visible;" nowrap="nowrap">
               
		                <a href="/web/20030902212405/http://wza.digitalbrains.com/DC/doc/Command_Types_(client_to_client).html" style="text-decoration:none;color:#33f;font-weight:bold;background-color:transparent;border:none;" title="2 Sep 2003"><strong>SEP</strong></a>
		                
               </td>
               <td id="displayMonthEl" style="background:#000;color:#ff0;font-size:11px!important;font-weight:bold;text-transform:uppercase;width:34px;height:15px;padding-top:1px;text-align:center;" title="You are here: 14:13:06 Feb 25, 2004">FEB</td>
				<td style="padding-left:9px;font-size:11px!important;font-weight:bold;text-transform:uppercase;white-space:nowrap;overflow:visible;" nowrap="nowrap">
               
		                <a href="/web/20040703052916/http://wza.digitalbrains.com/DC/doc/Command_Types_(client_to_client).html" style="text-decoration:none;color:#33f;font-weight:bold;background-color:transparent;border:none;" title="3 Jul 2004"><strong>JUL</strong></a>
		                
               </td>
           </tr>

           <!-- NEXT/PREV CAPTURE NAV AND DAY OF MONTH INDICATOR -->
           <tr>
               <td style="padding-right:9px;white-space:nowrap;overflow:visible;text-align:right!important;vertical-align:middle!important;" nowrap="nowrap">
               
		                <a href="/web/20030902212405/http://wza.digitalbrains.com/DC/doc/Command_Types_(client_to_client).html" title="21:24:05 Sep 2, 2003" style="background-color:transparent;border:none;"><img src="/static/images/toolbar/wm_tb_prv_on.png" alt="Previous capture" width="14" height="16" border="0" /></a>
		                
               </td>
               <td id="displayDayEl" style="background:#000;color:#ff0;width:34px;height:24px;padding:2px 0 0 0;text-align:center;font-size:24px;font-weight: bold;" title="You are here: 14:13:06 Feb 25, 2004">25</td>
				<td style="padding-left:9px;white-space:nowrap;overflow:visible;text-align:left!important;vertical-align:middle!important;" nowrap="nowrap">
               
		                <a href="/web/20040703052916/http://wza.digitalbrains.com/DC/doc/Command_Types_(client_to_client).html" title="5:29:16 Jul 3, 2004" style="background-color:transparent;border:none;"><img src="/static/images/toolbar/wm_tb_nxt_on.png" alt="Next capture" width="14" height="16" border="0"/></a>
		                
			    </td>
           </tr>

           <!-- NEXT/PREV YEAR NAV AND YEAR INDICATOR -->
           <tr style="width:110px;height:13px;font-size:9px!important;">
				<td style="padding-right:9px;font-size:11px!important;font-weight: bold;text-align:right;white-space:nowrap;overflow:visible;" nowrap="nowrap">
               
                       2003
                       
               </td>
               <td id="displayYearEl" style="background:#000;color:#ff0;font-size:11px!important;font-weight: bold;padding-top:1px;width:34px;height:13px;text-align:center;" title="You are here: 14:13:06 Feb 25, 2004">2004</td>
				<td style="padding-left:9px;font-size:11px!important;font-weight: bold;white-space:nowrap;overflow:visible;" nowrap="nowrap">
               
		                <a href="/web/20050430225244/http://wza.digitalbrains.com/DC/doc/Command_Types_(client_to_client).html" style="text-decoration:none;color:#33f;font-weight:bold;background-color:transparent;border:none;" title="30 Apr 2005"><strong>2005</strong></a>
		                
				</td>
           </tr>
           </tbody></table>
       </td>

       </tr>
       <tr>
       <td style="vertical-align:middle;padding:0!important;">
           <a href="/web/20040225141306*/http://wza.digitalbrains.com/DC/doc/Command_Types_(client_to_client).html" style="color:#33f;font-size:11px;font-weight:bold;background-color:transparent;border:none;" title="See a list of every capture for this URL"><strong>8 captures</strong></a>
           <div style="margin:0!important;padding:0!important;color:#666;font-size:9px;padding-top:2px!important;white-space:nowrap;" title="Timespan for captures of this URL">13 May 03 - 5 May 06</div>
       </td>
       <td style="padding:0!important;">
       <a style="position:relative; white-space:nowrap; width:450px;height:27px;" href="" id="wm-graph-anchor">
       <div id="wm-ipp-sparkline" style="position:relative; white-space:nowrap; width:450px;height:27px;background-color:#fff;cursor:pointer;border-right:1px solid #ccc;" title="Explore captures for this URL">
			<img id="sparklineImgId" style="position:absolute; z-index:9012; top:0px; left:0px;"
				onmouseover="showTrackers('inline');" 
				onmouseout="showTrackers('none');"
				onmousemove="trackMouseMove(event,this)"
				alt="sparklines"
				width="450"
				height="27"
				border="0"
				src="/web/jsp/graph.jsp?graphdata=450_27_1996:-1:000000000000_1997:-1:000000000000_1998:-1:000000000000_1999:-1:000000000000_2000:-1:000000000000_2001:-1:000000000000_2002:-1:000000000000_2003:-1:000010101000_2004:1:010000110000_2005:-1:000100000000_2006:-1:000010000000_2007:-1:000000000000_2008:-1:000000000000_2009:-1:000000000000_2010:-1:000000000000_2011:-1:000000000000_2012:-1:000000000000_2013:-1:000000000000"></img>
			<img id="wbMouseTrackYearImg" 
				style="display:none; position:absolute; z-index:9010;"
				width="25" 
				height="27"
				border="0"
				src="/static/images/toolbar/transp-yellow-pixel.png"></img>
			<img id="wbMouseTrackMonthImg"
				style="display:none; position:absolute; z-index:9011; " 
				width="2"
				height="27" 
				border="0"
				src="/static/images/toolbar/transp-red-pixel.png"></img>
       </div>
		</a>

       </td>
       </tr></tbody></table>
   </td>
   <td style="text-align:right;padding:5px;width:65px;font-size:11px!important;">
       <a href="javascript:;" onclick="document.getElementById('wm-ipp').style.display='none';" style="display:block;padding-right:18px;background:url(/static/images/toolbar/wm_tb_close.png) no-repeat 100% 0;color:#33f;font-family:'Lucida Grande','Arial',sans-serif;margin-bottom:23px;background-color:transparent;border:none;" title="Close the toolbar">Close</a>
       <a href="http://faq.web.archive.org/" style="display:block;padding-right:18px;background:url(/static/images/toolbar/wm_tb_help.png) no-repeat 100% 0;color:#33f;font-family:'Lucida Grande','Arial',sans-serif;background-color:transparent;border:none;" title="Get some help using the Wayback Machine">Help</a>
   </td>
   </tr></tbody></table>

</div>
</div>
<script type="text/javascript">
 var wmDisclaimBanner = document.getElementById("wm-ipp");
 if(wmDisclaimBanner != null) {
   disclaimElement(wmDisclaimBanner);
 }
</script>
<!-- END WAYBACK TOOLBAR INSERT -->

	&lt;<a href="/web/20040225141306/http://wza.digitalbrains.com/DC/doc/Introduction.html">Introduction / Contents</a>&gt;
	<h1>Command Types (client to client)</h1>
	
	<p>Direct Connect uses TCP and UDP for client to client communication.<br>
	Normally the client listen at port 412 for client connections, but if the port already in use it uses 413,414 and so on..<br>
	The following section describes the format of the Commands, Each field is denoted with <span class=variable>&lt; &gt;</span>.<br>
	The fields in the command are separated by a single space character (ASCII 32).<br>
	And each Command ends with a <span class=command>|</span> (pipe).  All Commands are case sensitive.</p>

	
	<h2>$GetListLen</h2>

	<p>The downloading client sends the <span class=command>$GetListLen</span> to request the filesize
	of the remote DCList in bytes.</p>
	<blockquote>
		$GetListLen
	</blockquote>

	<p>The uploading client responds to the <span class=command>$GetListLen</span> command with
	<span class=command>$ListLen</span>.</p>
	<blockquote>
		$ListLen <span class=variable>&lt;sizeinbyte&gt;</span>
	</blockquote>

	<ul>
		<li><span class=variable>&lt;sizeinbyte&gt;</span> is the filesize of the remote DCList in bytes.
	</ul>
	
	
	<h2>$MaxedOut</h2>
	
	<p>The <span class=command>$MaxedOut</span> command is sent when there are no free slots available from
	the uploading user.</p>
	<blockquote>
		$MaxedOut
	</blockquote>


	<h2>$Error</h2>
	
	<p>The <span class=command>$Error</span> command is sent when an error occurs, like file not found.</p>
	<blockquote>
		$Error <span class=variable>&lt;errormessage&gt;</span>
	</blockquote>

	<ul>
		<li><span class=variable>&lt;errormessage&gt;</span> is the message sent to the download client containing the error description.
	</ul>
	
	
	<h2>$Send</h2>
	
	<p>The <span class=command>$Send</span> command informs the uploading client, that the download will start.</p>
	<blockquote>
		$Send
	</blockquote>

	<p>Direct Connect sends upload data in chunks of 40906 bytes.  After every 40906 bytes is recived the downloading client must send the $Send again.</p>
	<font color=red>XXX what's this? never heard of any chunks,
	and dc++ certainly doesn't "$send" every 40906 bytes...that's the largest waste of time and
	resources I've ever seen? and it annoyed me to no end that the receiver is sending stuff during the
	send (because then you have to check the socket for reading while writing as well... /arnetheduck</font><br>
	<br>
	<font color=red>XXX hmm well, it worked for me, with VB winsock controls, i get many parts of data
	("chunks" or whatever word preffered) when i send $Send, and after 40960 bytes, i'd have to ask for
	some more, or the client wouldnt carry on sending.. atleast thats how i did it, maybe i did it wrong
	somehow but as mentioned, it works, with both clients /aDe</font>

	
	<h2>$Get</h2>
	
	<p>The <span class=command>$Get</span> command is used to request a file from the uploading client.</p>
	<blockquote>
		$Get <span class=variable>&lt;filenameandpath&gt;</span>$<span class=variable>&lt;resumecount&gt;</span>
	</blockquote>
	
	<ul>
		<li><span class=variable>&lt;filenameandpath&gt;</span> is the remote location of the file requested.
		<li><span class=variable>&lt;resumecount&gt;</span> is the byte offset to start at for resuming files.
	</ul>


	<h2>$FileLength</h2>
					
	<p>The <span class=command>$FileLength</span> is sent in response to the <span class=command>$Get</span>
	command.</p>
	<blockquote>
		$FileLength <span class=variable>&lt;sizeinbytes&gt;</span>
	</blockquote>
	
	<ul>
		<li><span class=variable>&lt;sizeinbytes&gt;</span> is the file size in bytes of the file requested with the
		<span class=command>$Get</span> command.
	</ul>
	
	
	<h2>$Canceled</h2>
	
	<p>The <span class=command>$Canceled</span> command is sent by eather party signifying that the download
	has been canceled prematurly.</p>
	<blockquote>
		$Canceled
	</blockquote>

	
	<h1>UDP Client To Client Commands</h1>
	
	<p>The following commands are the Client To Client UDP Commands.</p>
	
	<h2>$SR</h2>
	
	<p>The <span class=command>$SR</span> command is sent in response to a client searching.
	This is sent over UDP when the searching client is in Active Mode.</p>
	<blockquote>
		$SR <span class=variable>&lt;nick&gt;</span> <span class=variable>&lt;searchresponse&gt;</span> <span class=variable>&lt;hubip&gt;</span>:<span class=variable>&lt;hubport&gt;</span>
	</blockquote>

	<ul>
		<li><span class=variable>&lt;nick&gt;</span> is the nick of the user with the file.
		<li><span class=variable>&lt;hubip&gt;</span>:<span class=variable>&lt;hubport&gt;</span> are the values sent in the <span class=command>$Search</span> command.
	</ul>

	<p><span class=variable>&lt;searchresponse&gt;</span> is made up of</p>
	<blockquote>
		<span class=variable>&lt;filenamewithpath&gt;</span>&#5;<span class=variable>&lt;filesizeinbytes&gt;</span> <span class=variable>&lt;current openslots&gt;</span>/<span class=variable>&lt;allopenslots&gt;</span>&#5;<span class=variable>&lt;hubname&gt;</span>
	</blockquote>

	<ul>
		<li><span class=variable>&lt;filenamewithpath&gt;</span> is the location of the file on the remote client.
		<li><span class=variable>&lt;filesizeinbytes&gt;</span> is the size of the file found.
		<li><span class=variable>&lt;current openslots&gt;</span> is the number of free slots the remote client has available.
		<li><span class=variable>&lt;allopenslots&gt;</span> is the total number of slots the remote client has available.
		<li><span class=command>&#5;</span> is the ascii character 5.
    </ul>
	
	
	<h2>$Ping</h2>
	
	<p>I'm not sure what the purpose of this command is.</p>
	<blockquote>
		$Ping <span class=variable>&lt;senderIp&gt;</span>:<span class=variable>&lt;senderPort&gt;</span>
	</blockquote>
	
	<ul>
		<li><span class=variable>&lt;senderIp&gt;</span> is the Ip address of the client sending the command.
		<li><span class=variable>&lt;senderPort&gt;</span> is the UDP port the client is listening on (Usually the same as TCP port).
    </ul>

	<font color=red>XXX I've seen Ping's without arguments between the incoming search results /sed</font>
	
</body>
</html>





<!--
     FILE ARCHIVED ON 14:13:06 Feb 25, 2004 AND RETRIEVED FROM THE
     INTERNET ARCHIVE ON 20:53:42 Jan 19, 2013.
     JAVASCRIPT APPENDED BY WAYBACK MACHINE, COPYRIGHT INTERNET ARCHIVE.

     ALL OTHER CONTENT MAY ALSO BE PROTECTED BY COPYRIGHT (17 U.S.C.
     SECTION 108(a)(3)).
-->
