<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<!-- saved from url=(0099)http://web.archive.org/web/20110722002526/http://www.teamfair.info/wiki/index.php?title=Lock_to_key -->
<html lang="en" dir="ltr"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Lock to key - NMDC Protocol</title>

<meta name="generator" content="MediaWiki 1.16.5">
<link rel="alternate" type="application/x-wiki" title="Edit" href="http://web.archive.org/web/20110722002526/http://www.teamfair.info/wiki/index.php?title=Lock_to_key&action=edit">
<link rel="edit" title="Edit" href="http://web.archive.org/web/20110722002526/http://www.teamfair.info/wiki/index.php?title=Lock_to_key&action=edit">
<link rel="shortcut icon" href="http://web.archive.org/web/20110722002526im_/http://www.teamfair.info/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="http://web.archive.org/web/20110722002526/http://www.teamfair.info/wiki/opensearch_desc.php" title="NMDC Protocol (en)">
<link rel="alternate" type="application/atom+xml" title="NMDC Protocol Atom feed" href="http://web.archive.org/web/20110722002526/http://www.teamfair.info/wiki/index.php?title=Special:RecentChanges&feed=atom">
<link rel="stylesheet" href="http://web.archive.org/web/20110722002526cs_/http://www.teamfair.info/wiki/skins/common/shared.css?270" media="screen">
<link rel="stylesheet" href="http://web.archive.org/web/20110722002526cs_/http://www.teamfair.info/wiki/skins/common/commonPrint.css?270" media="print">
<link rel="stylesheet" href="http://web.archive.org/web/20110722002526cs_/http://www.teamfair.info/wiki/skins/monobook/main.css?270" media="screen">
<!--[if lt IE 5.5000]><link rel="stylesheet" href="/wiki/skins/monobook/IE50Fixes.css?270" media="screen" /><![endif]-->
<!--[if IE 5.5000]><link rel="stylesheet" href="/wiki/skins/monobook/IE55Fixes.css?270" media="screen" /><![endif]-->
<!--[if IE 6]><link rel="stylesheet" href="/wiki/skins/monobook/IE60Fixes.css?270" media="screen" /><![endif]-->
<!--[if IE 7]><link rel="stylesheet" href="/wiki/skins/monobook/IE70Fixes.css?270" media="screen" /><![endif]-->
<link rel="stylesheet" href="http://web.archive.org/web/20110722002526cs_/http://www.teamfair.info/wiki/index.php?title=MediaWiki:Common.css&usemsgcache=yes&ctype=text%2Fcss&smaxage=18000&action=raw&maxage=18000">
<link rel="stylesheet" href="http://web.archive.org/web/20110722002526cs_/http://www.teamfair.info/wiki/index.php?title=MediaWiki:Print.css&usemsgcache=yes&ctype=text%2Fcss&smaxage=18000&action=raw&maxage=18000" media="print">
<link rel="stylesheet" href="http://web.archive.org/web/20110722002526cs_/http://www.teamfair.info/wiki/index.php?title=MediaWiki:Monobook.css&usemsgcache=yes&ctype=text%2Fcss&smaxage=18000&action=raw&maxage=18000">
<link rel="stylesheet" href="http://web.archive.org/web/20110722002526cs_/http://www.teamfair.info/wiki/index.php?title=-&action=raw&maxage=18000&gen=css">
<script>
var skin="monobook",
stylepath="/wiki/skins",
wgUrlProtocols="http\\:\\/\\/|https\\:\\/\\/|ftp\\:\\/\\/|irc\\:\\/\\/|gopher\\:\\/\\/|telnet\\:\\/\\/|nntp\\:\\/\\/|worldwind\\:\\/\\/|mailto\\:|news\\:|svn\\:\\/\\/",
wgArticlePath="/wiki/index.php?title=$1",
wgScriptPath="/wiki",
wgScriptExtension=".php",
wgScript="/wiki/index.php",
wgVariantArticlePath=false,
wgActionPaths={},
wgServer="http://web.archive.org/web/20110722002526/http://www.teamfair.info/",
wgCanonicalNamespace="",
wgCanonicalSpecialPageName=false,
wgNamespaceNumber=0,
wgPageName="Lock_to_key",
wgTitle="Lock to key",
wgAction="view",
wgArticleId=111,
wgIsArticle=true,
wgUserName=null,
wgUserGroups=null,
wgUserLanguage="en",
wgContentLanguage="en",
wgBreakFrames=false,
wgCurRevisionId=872,
wgVersion="1.16.5",
wgEnableAPI=true,
wgEnableWriteAPI=true,
wgSeparatorTransformTable=["", ""],
wgDigitTransformTable=["", ""],
wgMainPageTitle="Main Page",
wgFormattedNamespaces={"-2": "Media", "-1": "Special", "0": "", "1": "Talk", "2": "User", "3": "User talk", "4": "NMDC Protocol", "5": "NMDC Protocol talk", "6": "File", "7": "File talk", "8": "MediaWiki", "9": "MediaWiki talk", "10": "Template", "11": "Template talk", "12": "Help", "13": "Help talk", "14": "Category", "15": "Category talk"},
wgNamespaceIds={"media": -2, "special": -1, "": 0, "talk": 1, "user": 2, "user_talk": 3, "nmdc_protocol": 4, "nmdc_protocol_talk": 5, "file": 6, "file_talk": 7, "mediawiki": 8, "mediawiki_talk": 9, "template": 10, "template_talk": 11, "help": 12, "help_talk": 13, "category": 14, "category_talk": 15, "image": 6, "image_talk": 7},
wgSiteName="NMDC Protocol",
wgCategories=[],
wgRestrictionEdit=[],
wgRestrictionMove=[];
</script><style type="text/css"></style><script src="./Lock to key - NMDC Protocol_files/wikibits.js"></script>
<script src="./Lock to key - NMDC Protocol_files/ajax.js"></script>
<script src="./Lock to key - NMDC Protocol_files/index.php"></script>

<style type="text/css">/*<![CDATA[*/
.source-python {line-height: normal;}
.source-python li, .source-python pre {
	line-height: normal; border: 0px none white;
}
/**
 * GeSHi Dynamically Generated Stylesheet
 * --------------------------------------
 * Dynamically generated stylesheet for python
 * CSS class: source-python, CSS id: 
 * GeSHi (C) 2004 - 2007 Nigel McNie, 2007 - 2008 Benny Baumann
 * (http://qbnz.com/highlighter/ and http://geshi.org/)
 * --------------------------------------
 */
.python.source-python .de1, .python.source-python .de2 {font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;}
.python.source-python  {font-family:monospace;}
.python.source-python .imp {font-weight: bold; color: red;}
.python.source-python li, .python.source-python .li1 {font-weight: normal; vertical-align:top;}
.python.source-python .ln {width:1px;text-align:right;margin:0;padding:0 2px;vertical-align:top;}
.python.source-python .li2 {font-weight: bold; vertical-align:top;}
.python.source-python .kw1 {color: #ff7700;font-weight:bold;}
.python.source-python .kw2 {color: #008000;}
.python.source-python .kw3 {color: #dc143c;}
.python.source-python .kw4 {color: #0000cd;}
.python.source-python .co1 {color: #808080; font-style: italic;}
.python.source-python .coMULTI {color: #808080; font-style: italic;}
.python.source-python .es0 {color: #000099; font-weight: bold;}
.python.source-python .br0 {color: black;}
.python.source-python .sy0 {color: #66cc66;}
.python.source-python .st0 {color: #483d8b;}
.python.source-python .nu0 {color: #ff4500;}
.python.source-python .me1 {color: black;}
.python.source-python .ln-xtra, .python.source-python li.ln-xtra, .python.source-python div.ln-xtra {background-color: #ffc;}
.python.source-python span.xtra { display:block; }

/*]]>*/
</style>
<style type="text/css">/*<![CDATA[*/
@import "/wiki/index.php?title=MediaWiki:Geshi.css&usemsgcache=yes&action=raw&ctype=text/css&smaxage=18000";
/*]]>*/
</style></head>
<body class="mediawiki ltr ns-0 ns-subject page-Lock_to_key skin-monobook"><div id="wm-ipp" style="display: block; position: relative; padding: 0px 5px; min-height: 70px; min-width: 800px; z-index: 9000;">
<div id="wm-ipp-inside" style="position:fixed;padding:0!important;margin:0!important;width:97%;min-width:780px;border:5px solid #000;border-top:none;background-image:url(http://staticweb.archive.org/images/toolbar/wm_tb_bk_trns.png);text-align:center;-moz-box-shadow:1px 1px 3px #333;-webkit-box-shadow:1px 1px 3px #333;box-shadow:1px 1px 3px #333;font-size:11px!important;font-family:&#39;Lucida Grande&#39;,&#39;Arial&#39;,sans-serif!important;">
   <table style="border-collapse:collapse;margin:0;padding:0;width:100%;"><tbody><tr>
   <td style="padding:10px;vertical-align:top;min-width:110px;">
   <a href="http://wayback.archive.org/web/" title="Wayback Machine home page" style="background-color:transparent;border:none;"><img src="./Lock to key - NMDC Protocol_files/wayback-toolbar-logo.png" alt="Wayback Machine" width="110" height="39" border="0"></a>
   </td>
   <td style="padding:0!important;text-align:center;vertical-align:top;width:100%;">

       <table style="border-collapse:collapse;margin:0 auto;padding:0;width:570px;"><tbody><tr>
       <td style="padding:3px 0;" colspan="2">
       <form target="_top" method="get" action="http://wayback.archive.org/web/form-submit.jsp" name="wmtb" id="wmtb" style="margin:0!important;padding:0!important;"><input type="text" name="url" id="wmtbURL" value="http://www.teamfair.info/wiki/index.php?title=Lock_to_key" style="width:400px;font-size:11px;font-family:&#39;Lucida Grande&#39;,&#39;Arial&#39;,sans-serif;" onfocus="javascript:this.focus();this.select();"><input type="hidden" name="type" value="replay"><input type="hidden" name="date" value="20110722002526"><input type="submit" value="Go" style="font-size:11px;font-family:&#39;Lucida Grande&#39;,&#39;Arial&#39;,sans-serif;margin-left:5px;"><span id="wm_tb_options" style="display:block;"></span></form>
       </td>
       <td style="vertical-align:bottom;padding:5px 0 0 0!important;" rowspan="2">
           <table style="border-collapse:collapse;width:110px;color:#99a;font-family:&#39;Helvetica&#39;,&#39;Lucida Grande&#39;,&#39;Arial&#39;,sans-serif;"><tbody>
			
           <!-- NEXT/PREV MONTH NAV AND MONTH INDICATOR -->
           <tr style="width:110px;height:16px;font-size:10px!important;">
           	<td style="padding-right:9px;font-size:11px!important;font-weight:bold;text-transform:uppercase;text-align:right;white-space:nowrap;overflow:visible;" nowrap="nowrap">
               
                       Jun
                       
               </td>
               <td id="displayMonthEl" style="background:#000;color:#ff0;font-size:11px!important;font-weight:bold;text-transform:uppercase;width:34px;height:15px;padding-top:1px;text-align:center;" title="You are here: 0:25:26 Jul 22, 2011">JUL</td>
				<td style="padding-left:9px;font-size:11px!important;font-weight:bold;text-transform:uppercase;white-space:nowrap;overflow:visible;" nowrap="nowrap">
               
                       Aug
                       
               </td>
           </tr>

           <!-- NEXT/PREV CAPTURE NAV AND DAY OF MONTH INDICATOR -->
           <tr>
               <td style="padding-right:9px;white-space:nowrap;overflow:visible;text-align:right!important;vertical-align:middle!important;" nowrap="nowrap">
               
                       <img src="./Lock to key - NMDC Protocol_files/wm_tb_prv_off.png" alt="Previous capture" width="14" height="16" border="0">
                       
               </td>
               <td id="displayDayEl" style="background:#000;color:#ff0;width:34px;height:24px;padding:2px 0 0 0;text-align:center;font-size:24px;font-weight: bold;" title="You are here: 0:25:26 Jul 22, 2011">22</td>
				<td style="padding-left:9px;white-space:nowrap;overflow:visible;text-align:left!important;vertical-align:middle!important;" nowrap="nowrap">
               
                       <img src="./Lock to key - NMDC Protocol_files/wm_tb_nxt_off.png" alt="Next capture" width="14" height="16" border="0">
                       
			    </td>
           </tr>

           <!-- NEXT/PREV YEAR NAV AND YEAR INDICATOR -->
           <tr style="width:110px;height:13px;font-size:9px!important;">
				<td style="padding-right:9px;font-size:11px!important;font-weight: bold;text-align:right;white-space:nowrap;overflow:visible;" nowrap="nowrap">
               
                       2010
                       
               </td>
               <td id="displayYearEl" style="background:#000;color:#ff0;font-size:11px!important;font-weight: bold;padding-top:1px;width:34px;height:13px;text-align:center;" title="You are here: 0:25:26 Jul 22, 2011">2011</td>
				<td style="padding-left:9px;font-size:11px!important;font-weight: bold;white-space:nowrap;overflow:visible;" nowrap="nowrap">
               
                       2012
                       
				</td>
           </tr>
           </tbody></table>
       </td>

       </tr>
       <tr>
       <td style="vertical-align:middle;padding:0!important;">
           <a href="http://wayback.archive.org/web/20110722002526*/http://www.teamfair.info/wiki/index.php?title=Lock_to_key" style="color:#33f;font-size:11px;font-weight:bold;background-color:transparent;border:none;" title="See a list of every capture for this URL"><strong>1 captures</strong></a>
           <div style="margin:0!important;padding:0!important;color:#666;font-size:9px;padding-top:2px!important;white-space:nowrap;" title="Timespan for captures of this URL">22 Jul 11 - 22 Jul 11</div>
       </td>
       <td style="padding:0!important;">
       <a style="position:relative; white-space:nowrap; width:450px;height:27px;" href="" id="wm-graph-anchor">
       <div id="wm-ipp-sparkline" style="position:relative; white-space:nowrap; width:450px;height:27px;background-color:#fff;cursor:pointer;border-right:1px solid #ccc;" title="Explore captures for this URL">
			<img id="sparklineImgId" style="position:absolute; z-index:9012; top:0px; left:0px;" onmouseover="showTrackers(&#39;inline&#39;);" onmouseout="showTrackers(&#39;none&#39;);" onmousemove="trackMouseMove(event,this)" alt="sparklines" width="450" height="27" border="0" src="./Lock to key - NMDC Protocol_files/graph.jsp">
			<img id="wbMouseTrackYearImg" style="display:none; position:absolute; z-index:9010;" width="25" height="27" border="0" src="./Lock to key - NMDC Protocol_files/transp-yellow-pixel.png">
			<img id="wbMouseTrackMonthImg" style="display:none; position:absolute; z-index:9011; " width="2" height="27" border="0" src="./Lock to key - NMDC Protocol_files/transp-red-pixel.png">
       </div>
		</a>

       </td>
       </tr></tbody></table>
   </td>
   <td style="text-align:right;padding:5px;width:65px;font-size:11px!important;">
       <a href="javascript:;" onclick="document.getElementById(&#39;wm-ipp&#39;).style.display=&#39;none&#39;;" style="display:block;padding-right:18px;background:url(http://staticweb.archive.org/images/toolbar/wm_tb_close.png) no-repeat 100% 0;color:#33f;font-family:&#39;Lucida Grande&#39;,&#39;Arial&#39;,sans-serif;margin-bottom:23px;background-color:transparent;border:none;" title="Close the toolbar">Close</a>
       <a href="http://faq.web.archive.org/" style="display:block;padding-right:18px;background:url(http://staticweb.archive.org/images/toolbar/wm_tb_help.png) no-repeat 100% 0;color:#33f;font-family:&#39;Lucida Grande&#39;,&#39;Arial&#39;,sans-serif;background-color:transparent;border:none;" title="Get some help using the Wayback Machine">Help</a>
   </td>
   </tr></tbody></table>

</div>
</div>
<!-- BEGIN WAYBACK TOOLBAR INSERT -->

<script type="text/javascript" src="./Lock to key - NMDC Protocol_files/disclaim-element.js"></script>
<script type="text/javascript" src="./Lock to key - NMDC Protocol_files/graph-calc.js"></script>
<script type="text/javascript" src="./Lock to key - NMDC Protocol_files/jquery.min.js"></script>
<script type="text/javascript">
//<![CDATA[
var firstDate = 820454400000;
var lastDate = 1356998399999;
var wbPrefix = "http://web.archive.org/web/";
var wbCurrentUrl = "http:\/\/www.teamfair.info\/wiki\/index.php?title=Lock_to_key";

var curYear = -1;
var curMonth = -1;
var yearCount = 18;
var firstYear = 1996;
var imgWidth=450;
var yearImgWidth = 25;
var monthImgWidth = 2;
var trackerVal = "none";
var displayDay = "22";
var displayMonth = "Jul";
var displayYear = "2011";
var prettyMonths = ["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];

function showTrackers(val) {
	if(val == trackerVal) {
		return;
	}
	if(val == "inline") {
		document.getElementById("displayYearEl").style.color = "#ec008c";
		document.getElementById("displayMonthEl").style.color = "#ec008c";
		document.getElementById("displayDayEl").style.color = "#ec008c";		
	} else {
		document.getElementById("displayYearEl").innerHTML = displayYear;
		document.getElementById("displayYearEl").style.color = "#ff0";
		document.getElementById("displayMonthEl").innerHTML = displayMonth;
		document.getElementById("displayMonthEl").style.color = "#ff0";
		document.getElementById("displayDayEl").innerHTML = displayDay;
		document.getElementById("displayDayEl").style.color = "#ff0";
	}
   document.getElementById("wbMouseTrackYearImg").style.display = val;
   document.getElementById("wbMouseTrackMonthImg").style.display = val;
   trackerVal = val;
}
function getElementX2(obj) {
	var thing = jQuery(obj);
	if((thing == undefined) 
			|| (typeof thing == "undefined") 
			|| (typeof thing.offset == "undefined")) {
		return getElementX(obj);
	}
	return Math.round(thing.offset().left);
}
function trackMouseMove(event,element) {

   var eventX = getEventX(event);
   var elementX = getElementX2(element);
   var xOff = eventX - elementX;
	if(xOff < 0) {
		xOff = 0;
	} else if(xOff > imgWidth) {
		xOff = imgWidth;
	}
   var monthOff = xOff % yearImgWidth;

   var year = Math.floor(xOff / yearImgWidth);
	var yearStart = year * yearImgWidth;
   var monthOfYear = Math.floor(monthOff / monthImgWidth);
   if(monthOfYear > 11) {
       monthOfYear = 11;
   }
   // 1 extra border pixel at the left edge of the year:
   var month = (year * 12) + monthOfYear;
   var day = 1;
	if(monthOff % 2 == 1) {
		day = 15;
	}
	var dateString = 
		zeroPad(year + firstYear) + 
		zeroPad(monthOfYear+1,2) +
		zeroPad(day,2) + "000000";

	var monthString = prettyMonths[monthOfYear];
	document.getElementById("displayYearEl").innerHTML = year + 1996;
	document.getElementById("displayMonthEl").innerHTML = monthString;
	// looks too jarring when it changes..
	//document.getElementById("displayDayEl").innerHTML = zeroPad(day,2);

	var url = wbPrefix + dateString + '/' +  wbCurrentUrl;
	document.getElementById('wm-graph-anchor').href = url;

   //document.getElementById("wmtbURL").value="evX("+eventX+") elX("+elementX+") xO("+xOff+") y("+year+") m("+month+") monthOff("+monthOff+") DS("+dateString+") Moy("+monthOfYear+") ms("+monthString+")";
   if(curYear != year) {
       var yrOff = year * yearImgWidth;
       document.getElementById("wbMouseTrackYearImg").style.left = yrOff + "px";
       curYear = year;
   }
   if(curMonth != month) {
       var mtOff = year + (month * monthImgWidth) + 1;
       document.getElementById("wbMouseTrackMonthImg").style.left = mtOff + "px";
       curMonth = month;
   }
}
//]]>
</script>

<style type="text/css">body{margin-top:0!important;padding-top:0!important;min-width:800px!important;}#wm-ipp a:hover{text-decoration:underline!important;}</style>

<script type="text/javascript">
 var wmDisclaimBanner = document.getElementById("wm-ipp");
 if(wmDisclaimBanner != null) {
   disclaimElement(wmDisclaimBanner);
 }
</script>
<!-- END WAYBACK TOOLBAR INSERT -->

<div id="globalWrapper">
<div id="column-content"><div id="content">
	<a id="top"></a>
	
	<h1 id="firstHeading" class="firstHeading">Lock to key</h1>
	<div id="bodyContent">
		<h3 id="siteSub">From NMDC Protocol</h3>
		<div id="contentSub"></div>
		<div id="jump-to-nav">Jump to: <a href="http://web.archive.org/web/20110722002526/http://www.teamfair.info/wiki/index.php?title=Lock_to_key#column-one">navigation</a>, <a href="http://web.archive.org/web/20110722002526/http://www.teamfair.info/wiki/index.php?title=Lock_to_key#searchInput">search</a></div>
		<!-- start content -->
<p>Here you will find some sources for lock to key generating.
</p>
<table id="toc" class="toc"><tbody><tr><td><div id="toctitle"><h2>Contents</h2> <span class="toctoggle">[<a id="togglelink" class="internal" href="javascript:toggleToc()">hide</a>]</span></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="http://web.archive.org/web/20110722002526/http://www.teamfair.info/wiki/index.php?title=Lock_to_key#Visual_Basic_.286.29"><span class="tocnumber">1</span> <span class="toctext">Visual Basic (6)</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="http://web.archive.org/web/20110722002526/http://www.teamfair.info/wiki/index.php?title=Lock_to_key#v1_-_unknown_author"><span class="tocnumber">1.1</span> <span class="toctext">v1 - unknown author</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-3"><a href="http://web.archive.org/web/20110722002526/http://www.teamfair.info/wiki/index.php?title=Lock_to_key#Java"><span class="tocnumber">2</span> <span class="toctext">Java</span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="http://web.archive.org/web/20110722002526/http://www.teamfair.info/wiki/index.php?title=Lock_to_key#v1_-_Unknown_author_2"><span class="tocnumber">2.1</span> <span class="toctext">v1 - Unknown author</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="http://web.archive.org/web/20110722002526/http://www.teamfair.info/wiki/index.php?title=Lock_to_key#v2_-_QuickSilver"><span class="tocnumber">2.2</span> <span class="toctext">v2 - QuickSilver</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-6"><a href="http://web.archive.org/web/20110722002526/http://www.teamfair.info/wiki/index.php?title=Lock_to_key#Delphi_.2F_Pascal"><span class="tocnumber">3</span> <span class="toctext">Delphi / Pascal</span></a>
<ul>
<li class="toclevel-2 tocsection-7"><a href="http://web.archive.org/web/20110722002526/http://www.teamfair.info/wiki/index.php?title=Lock_to_key#v1_-_unknown_author_3"><span class="tocnumber">3.1</span> <span class="toctext">v1 - unknown author</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="http://web.archive.org/web/20110722002526/http://www.teamfair.info/wiki/index.php?title=Lock_to_key#v2_-_by_Meka.5D.5BMeka"><span class="tocnumber">3.2</span> <span class="toctext">v2 - by Meka][Meka</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-9"><a href="http://web.archive.org/web/20110722002526/http://www.teamfair.info/wiki/index.php?title=Lock_to_key#Python"><span class="tocnumber">4</span> <span class="toctext">Python</span></a>
<ul>
<li class="toclevel-2 tocsection-10"><a href="http://web.archive.org/web/20110722002526/http://www.teamfair.info/wiki/index.php?title=Lock_to_key#v1_-_Unknown_author_4"><span class="tocnumber">4.1</span> <span class="toctext">v1 - Unknown author</span></a></li>
<li class="toclevel-2 tocsection-11"><a href="http://web.archive.org/web/20110722002526/http://www.teamfair.info/wiki/index.php?title=Lock_to_key#v2_-_Unknown_author"><span class="tocnumber">4.2</span> <span class="toctext">v2 - Unknown author</span></a></li>
<li class="toclevel-2 tocsection-12"><a href="http://web.archive.org/web/20110722002526/http://www.teamfair.info/wiki/index.php?title=Lock_to_key#v3_-_Unknown_author"><span class="tocnumber">4.3</span> <span class="toctext">v3 - Unknown author</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-13"><a href="http://web.archive.org/web/20110722002526/http://www.teamfair.info/wiki/index.php?title=Lock_to_key#C"><span class="tocnumber">5</span> <span class="toctext">C</span></a>
<ul>
<li class="toclevel-2 tocsection-14"><a href="http://web.archive.org/web/20110722002526/http://www.teamfair.info/wiki/index.php?title=Lock_to_key#v1_-_Unknown_author_5"><span class="tocnumber">5.1</span> <span class="toctext">v1 - Unknown author</span></a></li>
<li class="toclevel-2 tocsection-15"><a href="http://web.archive.org/web/20110722002526/http://www.teamfair.info/wiki/index.php?title=Lock_to_key#v2_-_Florinoprea"><span class="tocnumber">5.2</span> <span class="toctext">v2 - Florinoprea</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-16"><a href="http://web.archive.org/web/20110722002526/http://www.teamfair.info/wiki/index.php?title=Lock_to_key#Lua"><span class="tocnumber">6</span> <span class="toctext">Lua</span></a>
<ul>
<li class="toclevel-2 tocsection-17"><a href="http://web.archive.org/web/20110722002526/http://www.teamfair.info/wiki/index.php?title=Lock_to_key#v1_-_Unknown_author_6"><span class="tocnumber">6.1</span> <span class="toctext">v1 - Unknown author</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-18"><a href="http://web.archive.org/web/20110722002526/http://www.teamfair.info/wiki/index.php?title=Lock_to_key#PHP"><span class="tocnumber">7</span> <span class="toctext">PHP</span></a>
<ul>
<li class="toclevel-2 tocsection-19"><a href="http://web.archive.org/web/20110722002526/http://www.teamfair.info/wiki/index.php?title=Lock_to_key#v1_-_Burek"><span class="tocnumber">7.1</span> <span class="toctext">v1 - Burek</span></a></li>
<li class="toclevel-2 tocsection-20"><a href="http://web.archive.org/web/20110722002526/http://www.teamfair.info/wiki/index.php?title=Lock_to_key#v2_.28needs_some_modification_before_it_works.29"><span class="tocnumber">7.2</span> <span class="toctext">v2 (needs some modification before it works)</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-21"><a href="http://web.archive.org/web/20110722002526/http://www.teamfair.info/wiki/index.php?title=Lock_to_key#Perl"><span class="tocnumber">8</span> <span class="toctext">Perl</span></a></li>
<li class="toclevel-1 tocsection-22"><a href="http://web.archive.org/web/20110722002526/http://www.teamfair.info/wiki/index.php?title=Lock_to_key#Haskell"><span class="tocnumber">9</span> <span class="toctext">Haskell</span></a></li>
<li class="toclevel-1 tocsection-23"><a href="http://web.archive.org/web/20110722002526/http://www.teamfair.info/wiki/index.php?title=Lock_to_key#OCaml"><span class="tocnumber">10</span> <span class="toctext">OCaml</span></a></li>
<li class="toclevel-1 tocsection-24"><a href="http://web.archive.org/web/20110722002526/http://www.teamfair.info/wiki/index.php?title=Lock_to_key#any_other_language_will_follow_later"><span class="tocnumber">11</span> <span class="toctext">any other language will follow later</span></a></li>
</ul>
</td></tr></tbody></table><script>if (window.showTocToggle) { var tocShowText = "show"; var tocHideText = "hide"; showTocToggle(); } </script>
<h2><span class="editsection">[<a href="http://web.archive.org/web/20110722002526/http://www.teamfair.info/wiki/index.php?title=Lock_to_key&action=edit&section=1" title="Edit section: Visual Basic (6)">edit</a>]</span> <span class="mw-headline" id="Visual_Basic_.286.29"> Visual Basic (6) </span></h2>
<h3><span class="editsection">[<a href="http://web.archive.org/web/20110722002526/http://www.teamfair.info/wiki/index.php?title=Lock_to_key&action=edit&section=2" title="Edit section: v1 - unknown author">edit</a>]</span> <span class="mw-headline" id="v1_-_unknown_author"> v1 - unknown author</span></h3>
<p><br>
</p>
<pre>Public Function Lock2Key(StrLock As String) As String
   Dim TLock2Key As String, TChar As Integer
   If Len(StrLock) &lt; 3 Then
     Lock2Key = Left$("BROKENCLIENT", Len(StrLock))
     Exit Function
   End If
   TLock2Key = Chr$(Asc(Left$(StrLock, 1)) Xor Asc(Right$(StrLock, 1)) Xor Asc(Mid$(StrLock, Len(StrLock) - 1, 1)) Xor 5)
   For i = 2 To Len(StrLock)
       TLock2Key = TLock2Key &amp; Chr$(Asc(Mid$(StrLock, i, 1)) Xor Asc(Mid$(StrLock, i - 1, 1)))
   Next i
   For i = 1 To Len(TLock2Key)
       TChar = Asc(Mid$(TLock2Key, i, 1))
       TChar = TChar * 16 + TChar \ 16 'Swap bits 11110000 -&gt; 00001111
       TChar = TChar Mod 256
       If TChar = 0 Or TChar = 5 Or TChar = 36 Or TChar = 96 Or TChar = 124 Or TChar = 126 Then
           Lock2Key = Lock2Key &amp; "/%DCN" &amp; Right$("000" &amp; TChar, 3) &amp; "%/"
       Else
           Lock2Key = Lock2Key &amp; Chr$(TChar)
       End If
   Next i
End Function
</pre>
<p><br>
<br>
</p>
<pre>Case "$LOCK"
   'You've recived $LOCK, convert it to $KEY
   Dim sLock2 As String
   sLock2 = Split(Mid(sData2, 7), " Pk=")(0)
   sLock2 = Lock2Key(sLock2)
</pre>
<p><br>
</p>
<h2><span class="editsection">[<a href="http://web.archive.org/web/20110722002526/http://www.teamfair.info/wiki/index.php?title=Lock_to_key&action=edit&section=3" title="Edit section: Java">edit</a>]</span> <span class="mw-headline" id="Java"> Java </span></h2>
<h3><span class="editsection">[<a href="http://web.archive.org/web/20110722002526/http://www.teamfair.info/wiki/index.php?title=Lock_to_key&action=edit&section=4" title="Edit section: v1 - Unknown author">edit</a>]</span> <span class="mw-headline" id="v1_-_Unknown_author_2"> v1 - Unknown author </span></h3>
<pre>	private static final String CHARENCODING = "windows-1252";

	public static String generateKey(String lockstr) throws UnsupportedEncodingException { 

		byte[] lock = lockstr.split(" ", 3)[1].getBytes(CHARENCODING); 

		byte[] key =  new byte[lock.length];

		for (int i = 1; i &lt; lock.length; i++) {
			key[i] = (byte) ((lock[i] ^ lock[i - 1]) &amp; 0xFF);
		}

		key[0] = (byte) ((((lock[0] ^ lock[lock.length - 1]) ^ lock[lock.length - 2]) ^ 5) &amp; 0xFF);

		for (int i = 0; i &lt; key.length; i++) {
			key[i] = (byte) ((((key[i] &lt;&lt; 4) &amp; 0xF0) | ((key[i] &gt;&gt; 4) &amp; 0x0F)) &amp; 0xFF);
		}

		String modifiedLock = new String(key,CHARENCODING);
		
		return dcnEncode(modifiedLock); 
		
	}

	private static String dcnEncode(String lockstring) {
		for (int i: new int[]{0,5,36,96,124,126}) {
			String paddedDecimal = String.format("%03d", i); 
			String paddedHex     = String.format("%02x", i);
			lockstring = lockstring.replaceAll("\\x"+paddedHex, "/%DCN"+paddedDecimal+"%/");
		}
		return "$Key "+lockstring+"|";
	}


</pre>
<h3><span class="editsection">[<a href="http://web.archive.org/web/20110722002526/http://www.teamfair.info/wiki/index.php?title=Lock_to_key&action=edit&section=5" title="Edit section: v2 - QuickSilver">edit</a>]</span> <span class="mw-headline" id="v2_-_QuickSilver"> v2 - QuickSilver </span></h3>
<pre>public static byte[] generateKey(String lockstr, Charset cs) throws UnsupportedEncodingException {
        int firstpos = lockstr.indexOf(' ');
        int lastpos = lockstr.indexOf(" Pk=");
        if (lastpos &lt; 0) {
            lastpos = lockstr.indexOf(' ', firstpos + 1);
        }
//System.out.println(lockstr);

        byte[] lock = lockstr.substring(firstpos + 1, lastpos).getBytes(cs.name()); //lockstr.split(" ", 3)[1].getBytes(cs.name());

        byte[] key = new byte[lock.length];

        for (int i = 1; i
                &lt; lock.length; i++) {
            key[i] = (byte) ((lock[i] ^ lock[i - 1]) &amp; 0xFF);
        }

        key[0] = (byte) ((((lock[0] ^ lock[lock.length - 1]) ^ lock[lock.length - 2]) ^ 5) &amp; 0xFF);

        for (int i = 0; i
                &lt; key.length; i++) {
            key[i] = (byte) ((((key[i] &lt;&lt; 4) &amp; 0xF0) | ((key[i] &gt;&gt; 4) &amp; 0x0F)) &amp; 0xFF);
        }

        byte[] dcnEncoded = dcnEncode(key, cs);


        byte[] completeKey = new byte[dcnEncoded.length + 6];
        completeKey[0] = '$';
        completeKey[1] = 'K';
        completeKey[2] = 'e';
        completeKey[3] = 'y';
        completeKey[4] = ' ';
        completeKey[completeKey.length - 1] = '|';

        System.arraycopy(dcnEncoded, 0, completeKey, 5, dcnEncoded.length);


        return completeKey;

    }

    private static byte[] dcnEncode(byte[] lock, Charset cs) throws UnsupportedEncodingException {

        List&lt;Byte&gt; encoded = new ArrayList&lt;Byte&gt;();

        for (byte b&nbsp;: lock) {
            if (b == 0 || b == 5 || b == 36 || b == 96 || b == 124 || b == 126) {
                String paddedDecimal = "/%DCN" + String.format("%03d", (int) b) + "%/";

                for (byte dcn&nbsp;: paddedDecimal.getBytes(cs.name())) {
                    encoded.add(dcn);
                }

            } else {
                encoded.add(b);
            }

        }

        byte[] encodedBytes = new byte[encoded.size()];

        for (int i = 0; i
                &lt; encodedBytes.length; i++) {
            encodedBytes[i] = encoded.get(i);
        }

        return encodedBytes;
    }
</pre>
<h2><span class="editsection">[<a href="http://web.archive.org/web/20110722002526/http://www.teamfair.info/wiki/index.php?title=Lock_to_key&action=edit&section=6" title="Edit section: Delphi / Pascal">edit</a>]</span> <span class="mw-headline" id="Delphi_.2F_Pascal"> Delphi / Pascal </span></h2>
<h3><span class="editsection">[<a href="http://web.archive.org/web/20110722002526/http://www.teamfair.info/wiki/index.php?title=Lock_to_key&action=edit&section=7" title="Edit section: v1 - unknown author">edit</a>]</span> <span class="mw-headline" id="v1_-_unknown_author_3"> v1 - unknown author </span></h3>
<pre> function LockToKey (StrLock&nbsp;: string)&nbsp;: string;
     
  // The follow function converts "1" (byte) to "001" (string), "10" to "010" and so on
  function ByteToThreeCharStr (Value&nbsp;: byte)&nbsp;: string;
  begin
     if value &lt; 10 then
       result&nbsp;:= '00'+inttostr(value)
     else
    if value &lt; 100 then
      result&nbsp;:= '0'+inttostr(value)
    else
      result&nbsp;:= inttostr(value);
  end;

var i&nbsp;: byte;
    Temp&nbsp;: string;
    TempChar&nbsp;: byte;

begin
  result&nbsp;:= '';
  if length (StrLock) &lt; 3 then 
    begin
      result&nbsp;:= 'BROKENCLIENT';
      setlength (result,length(strlock));
      exit;
    end;

  // First char
  temp&nbsp;:= chr (ord (StrLock[1]) xor ord (StrLock[length(StrLock)])
    xor ord (StrLock[length(strLock)-1]) xor 5);

  for i&nbsp;:= 2 to length (StrLock) do
    temp&nbsp;:= temp + chr (ord(StrLock[i]) xor ord (StrLock[i-1]));

  for i&nbsp;:= 1 to length (temp) do
  begin
    TempChar&nbsp;:= ord (temp[i]);
    
    // I now used assembler. In the visual basic code the same was done with ugly math
    asm
      ror TempChar, 4 // &lt;- Nibble swap! We swap the last four bits with the first four: 00101111 -&gt; 11110010
    end;

    // Some chars need to be replaced with a string like "/%DCN005%/"
    If (TempChar = 0) or (TempChar = 5) or (TempChar = 36) or (TempChar = 96)
      or (TempChar = 124) or (TempChar = 126)
    then
      result&nbsp;:= result + '/%DCN' + ByteToThreeCharStr(TempChar) + '%/'
    else
      result&nbsp;:= result + chr (TempChar);
  end;
end;
</pre>
<h3><span class="editsection">[<a href="http://web.archive.org/web/20110722002526/http://www.teamfair.info/wiki/index.php?title=Lock_to_key&action=edit&section=8" title="Edit section: v2 - by Meka][Meka">edit</a>]</span> <span class="mw-headline" id="v2_-_by_Meka.5D.5BMeka"> v2 - by Meka][Meka </span></h3>
<pre>procedure mekaLockToKey(const Lock: array of byte; const ptrBuffer: PAnsiChar);
////////////////////////////////
/////    mekaLockToKey    //////
/////    by Meka][Meka    //////
/////  www.meka-meka.com  //////
////////////////////////////////
type
  meka = array[1..10] of ansichar;
var
  i, v, iCount: Integer;
  byTemp1: byte;
begin
  iCount&nbsp;:= 0;

  while Lock[iCount] &lt;&gt; 0 do begin
    if (Lock[iCount+1] = 32) and (Lock[iCount+2] = 80) and (Lock[iCount+3] = 107) and (Lock[iCount+4] = 61) then break;
    Inc(iCount);
  end;

  if iCount &lt;= 3 then begin
    byte((@ptrBuffer[0])^)&nbsp;:= 0;
    exit;
  end;

  byte((@ptrBuffer[0])^)&nbsp;:= ((Lock[0] xor Lock[iCount-1] xor Lock[iCount] xor 5) shl 4) or ((Lock[0] xor Lock[iCount-1] xor Lock[iCount] xor 5) shr 4);

  i&nbsp;:= 1;
  v&nbsp;:= 1;
  while i &lt;= iCount do begin
    byTemp1&nbsp;:= ((Lock[i] xor Lock[i - 1]) shl 4) or ((Lock[i] xor Lock[i - 1]) shr 4);

    case byTemp1 of
      0:
              begin
                meka((@ptrBuffer[v])^)&nbsp;:= '/%DCN000%/';
                Inc(v, 10);
              end;
      5:
              begin
                meka((@ptrBuffer[v])^)&nbsp;:= '/%DCN005%/';
                Inc(v, 10);
              end;
      36:
              begin
                meka((@ptrBuffer[v])^)&nbsp;:= '/%DCN036%/';
                Inc(v, 10);
              end;
      96:
              begin
                meka((@ptrBuffer[v])^)&nbsp;:= '/%DCN096%/';
                Inc(v, 10);
              end;
      124:
              begin
                meka((@ptrBuffer[v])^)&nbsp;:= '/%DCN124%/';
                Inc(v, 10);
              end;
      126:
              begin
                meka((@ptrBuffer[v])^)&nbsp;:= '/%DCN126%/';
                Inc(v, 10);
              end;
    else
      byte((@ptrBuffer[v])^)&nbsp;:= byTemp1;
      Inc(v);
    end;

    Inc(i);
  end;

  byte((@ptrBuffer[v])^)&nbsp;:= 0;
end;
</pre>
<h2><span class="editsection">[<a href="http://web.archive.org/web/20110722002526/http://www.teamfair.info/wiki/index.php?title=Lock_to_key&action=edit&section=9" title="Edit section: Python">edit</a>]</span> <span class="mw-headline" id="Python"> Python </span></h2>
<h3><span class="editsection">[<a href="http://web.archive.org/web/20110722002526/http://www.teamfair.info/wiki/index.php?title=Lock_to_key&action=edit&section=10" title="Edit section: v1 - Unknown author">edit</a>]</span> <span class="mw-headline" id="v1_-_Unknown_author_4"> v1 - Unknown author </span></h3>
<pre>    lock = self.sock.recv(1024)
    lock = re.findall('\$Lock[\s](.*?)[\s]', lock)[0]
    
    key = {}
    
    for i in xrange(1, len(lock)):
        key[i] = ord(lock[i]) ^ ord(lock[i-1])
    
    key[0] = ord(lock[0]) ^ ord(lock[-1]) ^ ord(lock[-2]) ^ 5
    for i in xrange(0, len(lock)):
            key[i] = ((key[i]&lt;&lt;4) &amp; 240) | ((key[i]&gt;&gt;4) &amp; 15)
    
    out = ""
    for i in xrange(0, len(lock)):
    	out += unichr(key[i])
    
    out = out.replace(u'\0', u'/%DCN000%/').replace(u'\5', u'/%DCN005%/').replace(u'\44', u'/%DCN036%/')
    out = out.replace(u'\140', u'/%DCN096%/').replace(u'\174', u'/%DCN124%/').replace(u'\176', u'/%DCN126%/')
</pre>
<h3><span class="editsection">[<a href="http://web.archive.org/web/20110722002526/http://www.teamfair.info/wiki/index.php?title=Lock_to_key&action=edit&section=11" title="Edit section: v2 - Unknown author">edit</a>]</span> <span class="mw-headline" id="v2_-_Unknown_author"> v2 - Unknown author </span></h3>
<p>The above code doesn't work for me (Ubuntu 8.10 / Python 2.5.2). Here's an alternative that works:
</p>
<div dir="ltr" style="text-align: left;"><div class="python source-python" style="font-family:monospace;"><pre class="de1"><span class="co1"># "lock" must be the exact lock character sequence, not the whole command.</span>
<span class="co1"># i.e. if the command is $Lock blah pk=bleh|, lock should be "blah"</span>
<span class="kw1">def</span> lock_to_key<span class="br0">(</span>lock<span class="br0">)</span>:
	<span class="st0">"Decrypts lock to key."</span>
	key = <span class="br0">{</span><span class="br0">}</span>
	<span class="kw1">for</span> i <span class="kw1">in</span> <span class="kw2">xrange</span><span class="br0">(</span><span class="nu0">1</span>, <span class="kw2">len</span><span class="br0">(</span>lock<span class="br0">)</span><span class="br0">)</span>:
		key<span class="br0">[</span>i<span class="br0">]</span> = <span class="kw2">ord</span><span class="br0">(</span>lock<span class="br0">[</span>i<span class="br0">]</span><span class="br0">)</span> ^ <span class="kw2">ord</span><span class="br0">(</span>lock<span class="br0">[</span>i-<span class="nu0">1</span><span class="br0">]</span><span class="br0">)</span>
	key<span class="br0">[</span><span class="nu0">0</span><span class="br0">]</span> = <span class="kw2">ord</span><span class="br0">(</span>lock<span class="br0">[</span><span class="nu0">0</span><span class="br0">]</span><span class="br0">)</span> ^ <span class="kw2">ord</span><span class="br0">(</span>lock<span class="br0">[</span>-<span class="nu0">1</span><span class="br0">]</span><span class="br0">)</span> ^ <span class="kw2">ord</span><span class="br0">(</span>lock<span class="br0">[</span>-<span class="nu0">2</span><span class="br0">]</span><span class="br0">)</span> ^ <span class="nu0">5</span>
	<span class="kw1">for</span> i <span class="kw1">in</span> <span class="kw2">xrange</span><span class="br0">(</span><span class="nu0">0</span>, <span class="kw2">len</span><span class="br0">(</span>lock<span class="br0">)</span><span class="br0">)</span>:
		key<span class="br0">[</span>i<span class="br0">]</span> = <span class="br0">(</span><span class="br0">(</span>key<span class="br0">[</span>i<span class="br0">]</span><span class="sy0">&lt;&lt;</span><span class="nu0">4</span><span class="br0">)</span> <span class="sy0">&amp;</span> <span class="nu0">240</span><span class="br0">)</span> | <span class="br0">(</span><span class="br0">(</span>key<span class="br0">[</span>i<span class="br0">]</span><span class="sy0">&gt;&gt;</span><span class="nu0">4</span><span class="br0">)</span> <span class="sy0">&amp;</span> <span class="nu0">15</span><span class="br0">)</span>
	out = <span class="st0">""</span>
	<span class="kw1">for</span> i <span class="kw1">in</span> <span class="kw2">xrange</span><span class="br0">(</span><span class="nu0">0</span>, <span class="kw2">len</span><span class="br0">(</span>key<span class="br0">)</span><span class="br0">)</span>:
		<span class="kw1">if</span> key<span class="br0">[</span>i<span class="br0">]</span> <span class="kw1">in</span> <span class="br0">(</span><span class="nu0">0</span>, <span class="nu0">5</span>, <span class="nu0">36</span>, <span class="nu0">96</span>, <span class="nu0">124</span>, <span class="nu0">126</span><span class="br0">)</span>:
			out += <span class="st0">"/%%DCN%03d%%/"</span> <span class="sy0">%</span> <span class="br0">(</span>key<span class="br0">[</span>i<span class="br0">]</span>,<span class="br0">)</span>
		<span class="kw1">else</span>:
			out += <span class="kw2">chr</span><span class="br0">(</span>key<span class="br0">[</span>i<span class="br0">]</span><span class="br0">)</span>
	<span class="kw1">return</span> out</pre></div></div>
<h3><span class="editsection">[<a href="http://web.archive.org/web/20110722002526/http://www.teamfair.info/wiki/index.php?title=Lock_to_key&action=edit&section=12" title="Edit section: v3 - Unknown author">edit</a>]</span> <span class="mw-headline" id="v3_-_Unknown_author"> v3 - Unknown author </span></h3>
<p>A reworked version of the above function, cleaner (more Pythonic?) and commented.
</p>
<div dir="ltr" style="text-align: left;"><div class="python source-python" style="font-family:monospace;"><pre class="de1">lock_to_key<span class="br0">(</span>lock<span class="br0">)</span>:
    <span class="st0">"""Creates a key from the lock string.
&nbsp;
    """</span>
    <span class="co1"># Convert to integers</span>
    lock = <span class="kw2">map</span><span class="br0">(</span><span class="kw2">ord</span>, lock<span class="br0">)</span>
&nbsp;
    <span class="co1"># XOR to create the initial key</span>
    key = <span class="br0">[</span>lock<span class="br0">[</span><span class="nu0">0</span><span class="br0">]</span> ^ lock<span class="br0">[</span>-<span class="nu0">1</span><span class="br0">]</span> ^ lock<span class="br0">[</span>-<span class="nu0">2</span><span class="br0">]</span> ^ <span class="nu0">5</span><span class="br0">]</span>
    <span class="kw1">for</span> a, b <span class="kw1">in</span> <span class="kw2">zip</span><span class="br0">(</span>lock, lock<span class="br0">[</span><span class="nu0">1</span>:<span class="br0">]</span><span class="br0">)</span>:
        key.<span class="me1">append</span><span class="br0">(</span>a ^ b<span class="br0">)</span>
&nbsp;
    <span class="co1"># Nibble-swap the key values</span>
    key = <span class="br0">[</span><span class="br0">(</span><span class="br0">(</span>c <span class="sy0">&lt;&lt;</span> <span class="nu0">4</span><span class="br0">)</span> <span class="sy0">&amp;</span> <span class="nu0">240</span><span class="br0">)</span> | <span class="br0">(</span><span class="br0">(</span>c <span class="sy0">&gt;&gt;</span> <span class="nu0">4</span><span class="br0">)</span> <span class="sy0">&amp;</span> <span class="nu0">15</span><span class="br0">)</span> <span class="kw1">for</span> c <span class="kw1">in</span> key<span class="br0">]</span>
&nbsp;
    <span class="co1"># Escape and convert to characters</span>
    <span class="kw1">def</span> convert<span class="br0">(</span>c<span class="br0">)</span>:
        <span class="kw1">if</span> c <span class="kw1">in</span> <span class="br0">(</span><span class="nu0">0</span>, <span class="nu0">5</span>, <span class="nu0">36</span>, <span class="nu0">96</span>, <span class="nu0">124</span>, <span class="nu0">126</span><span class="br0">)</span>:
            <span class="kw1">return</span> <span class="st0">'/%%DCN%03d%%/'</span> <span class="sy0">%</span> c
        <span class="kw1">else</span>:
            <span class="kw1">return</span> <span class="kw2">chr</span><span class="br0">(</span>c<span class="br0">)</span>
    <span class="kw1">return</span> <span class="st0">''</span>.<span class="me1">join</span><span class="br0">(</span><span class="kw2">map</span><span class="br0">(</span>convert, key<span class="br0">)</span><span class="br0">)</span></pre></div></div>
<h2><span class="editsection">[<a href="http://web.archive.org/web/20110722002526/http://www.teamfair.info/wiki/index.php?title=Lock_to_key&action=edit&section=13" title="Edit section: C">edit</a>]</span> <span class="mw-headline" id="C"> C </span></h2>
<h3><span class="editsection">[<a href="http://web.archive.org/web/20110722002526/http://www.teamfair.info/wiki/index.php?title=Lock_to_key&action=edit&section=14" title="Edit section: v1 - Unknown author">edit</a>]</span> <span class="mw-headline" id="v1_-_Unknown_author_5"> v1 - Unknown author </span></h3>
<pre>char *lock_to_key(const char *lock)
{
        int len = strlen(lock);
        char *key = malloc(len * sizeof(char));

        int i;
        for(i = 1; i &lt; len; i++)
                key[i] = lock[i] ^ lock[i-1];
        key[0] = lock[0] ^ lock[len-1] ^ lock[len-2] ^ 5;

        for(i = 0; i &lt; len; i++)
                key[i] = ((key[i]&lt;&lt;4) &amp; 0xF0) | ((key[i]&gt;&gt;4) &amp; 0x0F);

        char *newkey = malloc((len + 100) * sizeof(char)); // FIXME: do dynamic check for overflow
        char *newkey_p = newkey;
        for(i = 0; i &lt; len; i++)
        {
                switch(key[i])
                {
                case 0:
                case 5:
                case 36:
                case 96:
                case 124:
                case 126:
                        sprintf(newkey_p, "/%%DCN%03d%%/", key[i]);
                        newkey_p += 10;
                        break;

                default:
                        *newkey_p = key[i];
                        newkey_p++;
                }
        }
        *newkey_p = '\0';
        free(key);
        return newkey;
}
</pre>
<p><br>
</p>
<h3><span class="editsection">[<a href="http://web.archive.org/web/20110722002526/http://www.teamfair.info/wiki/index.php?title=Lock_to_key&action=edit&section=15" title="Edit section: v2 - Florinoprea">edit</a>]</span> <span class="mw-headline" id="v2_-_Florinoprea"> v2 - Florinoprea </span></h3>
<pre>//changed by: florinoprea.contact@gmail.com
char *lock_to_key(const char *lock)
{
        int len = strlen(lock);
        char *key = malloc(len * sizeof(char));
        int len2 = 0;
        register int i;

        for(i = 1; i &lt; len; i++)
                key[i] = lock[i] ^ lock[i-1];
        key[0] = lock[0] ^ lock[len-1] ^ lock[len-2] ^ 5;

        for(i = 0; i &lt; len; i++)
        	{
                key[i] = ((key[i]&lt;&lt;4) &amp; 0xF0) | ((key[i]&gt;&gt;4) &amp; 0x0F);
                switch(key[i])
                {
                case 0:
                case 5:
                case 36:
                case 96:
                case 124:
                case 126:
			len2+=10;
			break;
		default:
		len2++;
                }
                }

        char *newkey = malloc((len2 + 1) * sizeof(char));//Junior: correct allocation of memory
        char *newkey_p = newkey;
        for(i = 0; i &lt; len; i++)
        {
                switch(key[i])
                {
                case 0:
                case 5:
                case 36:
                case 96:
                case 124:
                case 126:
                        sprintf(newkey_p, "/%%DCN%03d%%/", key[i]);
                        newkey_p += 10;
                        break;

                default:
                        *newkey_p = key[i];
                        newkey_p++;
                }
        }
        *newkey_p = '\0';
        free(key); //Junior: free memory
        return newkey;
}
</pre>
<h2><span class="editsection">[<a href="http://web.archive.org/web/20110722002526/http://www.teamfair.info/wiki/index.php?title=Lock_to_key&action=edit&section=16" title="Edit section: Lua">edit</a>]</span> <span class="mw-headline" id="Lua"> Lua </span></h2>
<h3><span class="editsection">[<a href="http://web.archive.org/web/20110722002526/http://www.teamfair.info/wiki/index.php?title=Lock_to_key&action=edit&section=17" title="Edit section: v1 - Unknown author">edit</a>]</span> <span class="mw-headline" id="v1_-_Unknown_author_6"> v1 - Unknown author </span></h3>
<pre>function lock2key(lock)
    local function bitwise(x, y, bw)
        local c, p = 0, 1
        local function bODD(x)
            return x ~= math.floor(x / 2) * 2
        end
        while x &gt; 0 or y &gt; 0 do
            if bw == "xor" then
                if (bODD(x) and not bODD(y)) or (bODD(y) and not bODD(x)) then
                    c = c + p
                end
            elseif bw == "and" then
                if bODD(x) and bODD(y) then
                    c = c + p
                end
            elseif bw == "or" then
                if bODD(x) or bODD(y) then
                    c = c + p
                end
            end
            x = math.floor(x / 2)
            y = math.floor(y / 2)
            p = p * 2
        end
        return c
    end
    
	local key = {}
    table.insert(key,bitwise(bitwise(bitwise(string.byte(lock,1),string.byte(lock,-1),"xor"),string.byte(lock,-2),"xor"),5,"xor"))
    for i=2,string.len(lock),1 do
		table.insert(key,bitwise(string.byte(lock,i),string.byte(lock,i - 1),"xor"))
    end
    
	local function nibbleswap(bits)
        return bitwise(bitwise(bits*(2^4),240,"and"),bitwise(math.floor(bits/(2^4)),15,"and"),"or")
    end
    
	local g = {["5"]=1,["0"]=1,["36"]=1,["96"]=1,["124"]=1,["126"]=1}
    for i=1,#key do -- Use table.getn in LUA5.02
		local b = nibbleswap(rawget(key,i))
		rawset(key,i,(g[tostring(b)] and string.format("/%%DCN%03d%%/",b) or string.char(b)))
    end
    
	return table.concat(key)
end
</pre>
<h2><span class="editsection">[<a href="http://web.archive.org/web/20110722002526/http://www.teamfair.info/wiki/index.php?title=Lock_to_key&action=edit&section=18" title="Edit section: PHP">edit</a>]</span> <span class="mw-headline" id="PHP"> PHP </span></h2>
<h3><span class="editsection">[<a href="http://web.archive.org/web/20110722002526/http://www.teamfair.info/wiki/index.php?title=Lock_to_key&action=edit&section=19" title="Edit section: v1 - Burek">edit</a>]</span> <span class="mw-headline" id="v1_-_Burek"> v1 - Burek </span></h3>
<pre>//------------------------------------------------------------------------------
function EscapeDCN($s) {
//------------------------------------------------------------------------------
	$search = array("\x00", "\x05", "\x24", "\x60", "\x7C", "\x7E");
	$replace = array('/%DCN000%/', '/%DCN005%/', '/%DCN036%/', '/%DCN096%/', '/%DCN124%/', '/%DCN126%/');
	return str_replace($search, $replace, $s);
}
//------------------------------------------------------------------------------
function LockToKey($lock) {
//------------------------------------------------------------------------------
	$len = strlen($lock);
	$key = array();
	for ($i = 1; $i &lt; $len; $i++)
		$key[$i] = ord($lock[$i]) ^ ord($lock[$i-1]);
	$key[0] = ord($lock[0]) ^ ord($lock[$len-1]) ^ ord($lock[$len-2]) ^ 5;
	for ($i = 0; $i &lt; $len; $i++)
		$key[$i] = chr((($key[$i] &lt;&lt; 4) &amp; 0xF0) | (($key[$i] &gt;&gt; 4) &amp; 0x0F));
	return EscapeDCN(implode('', $key));
}
</pre>
<h3><span class="editsection">[<a href="http://web.archive.org/web/20110722002526/http://www.teamfair.info/wiki/index.php?title=Lock_to_key&action=edit&section=20" title="Edit section: v2 (needs some modification before it works)">edit</a>]</span> <span class="mw-headline" id="v2_.28needs_some_modification_before_it_works.29"> v2 (needs some modification before it works)</span></h3>
<pre>function _lock2key($_LOCK) {
		// From: http://dcplusplus.sourceforge.net/wiki/index.php/LockToKey#PHP
	
		$lockLength = strlen ($_LOCK);
		$h = ord($_LOCK{0}) ^ ord( $_LOCK{ $lockLength - 1} ) ^ ord( $_LOCK{ $lockLength - 2} ) ^ 5;
		// echo $h . "&lt;br&gt;";
		while ($h &gt; 255) {
			$h -= 256;
		}
		
		$h = (($h&lt;&lt;4) &amp; 240) | (($h&gt;&gt;4) &amp; 15);
		$a = $h;
		
		if ($a == '126' or // '~'
			$a == '124' or // '|'
			$a == '96' or  // '`'
			$a == '36' or  // '$'
			$a == '5' or   // '^E'
			$a == '0')     // NUL
			{
			$LockToKey = "/%DCN";
			
			if ($a &lt; 100) $LockToKey .="0";
			if ($a &lt; 10) $LockToKey .="0";
			
			$LockToKey .= $a; // As a string integer
			$LockToKey .= "%/";
		} else {
			$LockToKey = chr ($a);  // No transformation.
		}
		
		for ($j = 1; $j &lt; strlen($_LOCK); $j++) {
			$h = ord($_LOCK{$j}) ^ ord($_LOCK{$j-1});
		
			while ($h &gt; 255) {
				$h -= 256;
			}
			
			$h = (($h&lt;&lt;4) &amp; 240) | (($h&gt;&gt;4) &amp; 15);
			
			// echo $j . " - " . ($h*16) . "";
			$a = $h;
			
			if ($a == '126' or // '~'
				$a == '124' or // '|'
				$a == '96' or  // '`'
				$a == '36' or  // '$'
				$a == '5' or   // '^E'
				$a == '0')     // NUL
				{
				$LockToKey .= "/%DCN";
			
				if ($a &lt; 100) $LockToKey .="0";
				if ($a &lt; 10) $LockToKey .="0";
				
				$LockToKey .= $a; // As a string integer
				$LockToKey .= "%/";
				
			} else {
				$LockToKey .= chr ($a);  // No transformation.
			}
		}
		
		return $LockToKey;
	}
</pre>
<h2><span class="editsection">[<a href="http://web.archive.org/web/20110722002526/http://www.teamfair.info/wiki/index.php?title=Lock_to_key&action=edit&section=21" title="Edit section: Perl">edit</a>]</span> <span class="mw-headline" id="Perl"> Perl </span></h2>
<pre>sub lock2key($)
{
	my @lock = split(//, shift);
	my @key;
	# convert to ordinal
	$_=ord foreach @lock;
	# calc key[0] with some xor-ing magic
	push(@key,$lock[0]^5);
	# calc rest of key with some other xor-ing magic
	for my $i (1 .. $#lock)
	{
		push(@key, ($lock[$i]^$lock[$i-1]));
	}
	# nibble swapping
	foreach (@key)
	{
		$_ = ((($_ &lt;&lt; 4) &amp; 240) | (($_ &gt;&gt; 4) &amp; 15)) &amp; 0xff;
	}
	$key[0] ^= $key[-1];
	# escape some
	foreach (@key)
	{
		$_ = ( $_ == 0 || $_ == 5 || $_ == 36 || $_ == 96 || $_ == 124 || $_ == 126 )&nbsp;? sprintf('/%%DCN%03i%%/', $_)&nbsp;: chr;
	}
	# done
	return join('', @key);
}
</pre>
<h2><span class="editsection">[<a href="http://web.archive.org/web/20110722002526/http://www.teamfair.info/wiki/index.php?title=Lock_to_key&action=edit&section=22" title="Edit section: Haskell">edit</a>]</span> <span class="mw-headline" id="Haskell"> Haskell </span></h2>
<pre>import Data.Bits
import Data.Char
import Text.Printf

lockToKey = toDCString . c . a . map ord
  where toDCString = concat . map (\b -&gt; if b `elem` [0,5,36,96,124,126] then printf "/%%DCN%03d%%/" b else [chr b])
        a l@(x:xs) = x `xor` last xs `xor` last (init l) `xor` 5&nbsp;: b l
        b l        = flip map [1..length l -1] $ \i -&gt; (l&nbsp;!! i) `xor` (l&nbsp;!! (i-1))
        c          = map $ \d -&gt; ((d `shiftL` 4) .&amp;. 0xF0) .|. ((d `shiftR` 4) .&amp;. 0x0F)
</pre>
<h2><span class="editsection">[<a href="http://web.archive.org/web/20110722002526/http://www.teamfair.info/wiki/index.php?title=Lock_to_key&action=edit&section=23" title="Edit section: OCaml">edit</a>]</span> <span class="mw-headline" id="OCaml"> OCaml </span></h2>
<pre>let lock2key lock =
  let len = String.length lock in
  let key = Array.make len 0 in
  let l n = Char.code lock.[n] in
  Array.iteri (fun i n -&gt; key.(i) &lt;-
    if i == 0 then l i lxor l (len-1) lxor l (len-2) lxor 5
    else           l i lxor l (i-1)
  ) key;
  Array.fold_left (fun str n -&gt;
    str ^ match ((n lsl 4) lor (n lsr 4)) land 255 with
    |   0 -&gt; "/%DCN000%/" |   5 -&gt; "/%DCN005%/" |  36 -&gt; "/%DCN036%/"
    |  96 -&gt; "/%DCN096%/" | 124 -&gt; "/%DCN124%/" | 126 -&gt; "/%DCN126%/"
    |   c -&gt; String.make 1 (Char.chr c)
  ) "" key
</pre>
<h2><span class="editsection">[<a href="http://web.archive.org/web/20110722002526/http://www.teamfair.info/wiki/index.php?title=Lock_to_key&action=edit&section=24" title="Edit section: any other language will follow later">edit</a>]</span> <span class="mw-headline" id="any_other_language_will_follow_later"> any other language will follow later </span></h2>

<!-- 
NewPP limit report
Preprocessor node count: 230/1000000
Post-expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Expensive parser function count: 0/100
-->

<!-- Saved in parser cache with key wikidb-mw_:pcache:idhash:111-0!1!0!!en!2 and timestamp 20110722002645 -->
<div class="printfooter">
Retrieved from "<a href="./Lock to key - NMDC Protocol_files/Lock to key - NMDC Protocol.htm">http://www.teamfair.info/wiki/index.php?title=Lock_to_key</a>"</div>
		<div id="catlinks" class="catlinks catlinks-allhidden"></div>		<!-- end content -->
				<div class="visualClear"></div>
	</div>
</div></div>
<div id="column-one">
	<div id="p-cactions" class="portlet">
		<h5>Views</h5>
		<div class="pBody">
			<ul>
				 <li id="ca-nstab-main" class="selected"><a href="./Lock to key - NMDC Protocol_files/Lock to key - NMDC Protocol.htm" title="View the content page [alt-c]" accesskey="c">Page</a></li>
				 <li id="ca-talk"><a href="http://web.archive.org/web/20110722002526/http://www.teamfair.info/wiki/index.php?title=Talk:Lock_to_key" title="Discussion about the content page [alt-t]" accesskey="t">Discussion</a></li>
				 <li id="ca-edit"><a href="http://web.archive.org/web/20110722002526/http://www.teamfair.info/wiki/index.php?title=Lock_to_key&action=edit" title="You can edit this page. Please use the preview button before saving [alt-e]" accesskey="e">Edit</a></li>
				 <li id="ca-history"><a href="http://web.archive.org/web/20110722002526/http://www.teamfair.info/wiki/index.php?title=Lock_to_key&action=history" title="Past revisions of this page [alt-h]" accesskey="h">History</a></li>
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-personal">
		<h5>Personal tools</h5>
		<div class="pBody">
			<ul>
				<li id="pt-login"><a href="http://web.archive.org/web/20110722002526/http://www.teamfair.info/wiki/index.php?title=Special:UserLogin&returnto=Lock_to_key" title="You are encouraged to log in; however, it is not mandatory [alt-o]" accesskey="o">Log in / create account</a></li>
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-logo">
		<a style="background-image: url(http://web.archive.org/web/20110722002526im_/http://www.teamfair.info/wiki/skins/common/images/wiki.png);" href="http://web.archive.org/web/20110722002526/http://www.teamfair.info/wiki/index.php?title=Main_Page" title="Visit the main page"></a>
	</div>
	<script type="text/javascript"> if (window.isMSIE55) fixalpha(); </script>
	<div id="p-search" class="portlet">
		<h5><label for="searchInput">Search</label></h5>
		<div id="searchBody" class="pBody">
			<form action="http://web.archive.org/web/20110722002526/http://www.teamfair.info/wiki/index.php" id="searchform">
				<input type="hidden" name="title" value="Special:Search">
				<input id="searchInput" title="Search NMDC Protocol" accesskey="f" type="search" name="search">
				<input type="submit" name="go" class="searchButton" id="searchGoButton" value="Go" title="Go to a page with this exact name if exists">&nbsp;
				<input type="submit" name="fulltext" class="searchButton" id="mw-searchButton" value="Search" title="Search the pages for this text">
			</form>
		</div>
	</div>
	<div class="generated-sidebar portlet" id="p-Quicklinks">
		<h5>Quicklinks</h5>
		<div class="pBody">
			<ul>
				<li id="n-Hub---Hub"><a href="http://web.archive.org/web/20110722002526/http://www.teamfair.info/wiki/index.php?title=Category:Hub_-_Hub_Protocol">Hub - Hub</a></li>
				<li id="n-Client---Client"><a href="http://web.archive.org/web/20110722002526/http://www.teamfair.info/wiki/index.php?title=Category:Client_-_Client_Protocol">Client - Client</a></li>
				<li id="n-Client---Hub---Client"><a href="http://web.archive.org/web/20110722002526/http://www.teamfair.info/wiki/index.php?title=Category:Client_-_Hub_-_Client_Protocol">Client - Hub - Client</a></li>
				<li id="n-Hub---Client"><a href="http://web.archive.org/web/20110722002526/http://www.teamfair.info/wiki/index.php?title=Category:Hub_-_Client_Protocol">Hub - Client</a></li>
				<li id="n-Hub---Hublist"><a href="http://web.archive.org/web/20110722002526/http://www.teamfair.info/wiki/index.php?title=Category:Hub_-_Hublist_Protocol">Hub - Hublist</a></li>
				<li id="n-Pinger---Hub"><a href="http://web.archive.org/web/20110722002526/http://www.teamfair.info/wiki/index.php?title=Category:Pinger_-_Hub_Protocol">Pinger - Hub</a></li>
				<li id="n-Extentions"><a href="http://web.archive.org/web/20110722002526/http://www.teamfair.info/wiki/index.php?title=Category:Extentions_Protocol">Extentions</a></li>
			</ul>
		</div>
	</div>
	<div class="generated-sidebar portlet" id="p-navigation">
		<h5>Navigation</h5>
		<div class="pBody">
			<ul>
				<li id="n-mainpage-description"><a href="http://web.archive.org/web/20110722002526/http://www.teamfair.info/wiki/index.php?title=Main_Page" title="Visit the main page [alt-z]" accesskey="z">Main page</a></li>
				<li id="n-portal"><a href="http://web.archive.org/web/20110722002526/http://www.teamfair.info/wiki/index.php?title=NMDC_Protocol:Community_portal" title="About the project, what you can do, where to find things">Community portal</a></li>
				<li id="n-currentevents"><a href="http://web.archive.org/web/20110722002526/http://www.teamfair.info/wiki/index.php?title=NMDC_Protocol:Current_events" title="Find background information on current events">Current events</a></li>
				<li id="n-recentchanges"><a href="http://web.archive.org/web/20110722002526/http://www.teamfair.info/wiki/index.php?title=Special:RecentChanges" title="The list of recent changes in the wiki [alt-r]" accesskey="r">Recent changes</a></li>
				<li id="n-randompage"><a href="http://web.archive.org/web/20110722002526/http://www.teamfair.info/wiki/index.php?title=Special:Random" title="Load a random page [alt-x]" accesskey="x">Random page</a></li>
				<li id="n-help"><a href="http://web.archive.org/web/20110722002526/http://www.teamfair.info/wiki/index.php?title=Help:Contents" title="The place to find out">Help</a></li>
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-tb">
		<h5>Toolbox</h5>
		<div class="pBody">
			<ul>
				<li id="t-whatlinkshere"><a href="http://web.archive.org/web/20110722002526/http://www.teamfair.info/wiki/index.php?title=Special:WhatLinksHere/Lock_to_key" title="List of all wiki pages that link here [alt-j]" accesskey="j">What links here</a></li>
				<li id="t-recentchangeslinked"><a href="http://web.archive.org/web/20110722002526/http://www.teamfair.info/wiki/index.php?title=Special:RecentChangesLinked/Lock_to_key" title="Recent changes in pages linked from this page [alt-k]" accesskey="k">Related changes</a></li>
<li id="t-specialpages"><a href="http://web.archive.org/web/20110722002526/http://www.teamfair.info/wiki/index.php?title=Special:SpecialPages" title="List of all special pages [alt-q]" accesskey="q">Special pages</a></li>
				<li id="t-print"><a href="http://web.archive.org/web/20110722002526/http://www.teamfair.info/wiki/index.php?title=Lock_to_key&printable=yes" rel="alternate" title="Printable version of this page [alt-p]" accesskey="p">Printable version</a></li>				<li id="t-permalink"><a href="http://web.archive.org/web/20110722002526/http://www.teamfair.info/wiki/index.php?title=Lock_to_key&oldid=872" title="Permanent link to this revision of the page">Permanent link</a></li>			</ul>
		</div>
	</div>
</div><!-- end of the left (by default at least) column -->
<div class="visualClear"></div>
<div id="footer">
	<div id="f-poweredbyico"><a href="http://web.archive.org/web/20110722002526/http://www.mediawiki.org/"><img src="./Lock to key - NMDC Protocol_files/poweredby_mediawiki_88x31.png" height="31" width="88" alt="Powered by MediaWiki"></a></div>
	<ul id="f-list">
		<li id="lastmod"> This page was last modified on 19 May 2011, at 07:48.</li>
		<li id="viewcount">This page has been accessed 3,206 times.</li>
		<li id="privacy"><a href="http://web.archive.org/web/20110722002526/http://www.teamfair.info/wiki/index.php?title=NMDC_Protocol:Privacy_policy" title="NMDC Protocol:Privacy policy">Privacy policy</a></li>
		<li id="about"><a href="http://web.archive.org/web/20110722002526/http://www.teamfair.info/wiki/index.php?title=NMDC_Protocol:About" title="NMDC Protocol:About">About NMDC Protocol</a></li>
		<li id="disclaimer"><a href="http://web.archive.org/web/20110722002526/http://www.teamfair.info/wiki/index.php?title=NMDC_Protocol:General_disclaimer" title="NMDC Protocol:General disclaimer">Disclaimers</a></li>
	</ul>
</div>
</div>

<script>if (window.runOnloadHook) runOnloadHook();</script>
<!-- Served in 0.996 secs. -->





<!--
     FILE ARCHIVED ON 0:25:26 Jul 22, 2011 AND RETRIEVED FROM THE
     INTERNET ARCHIVE ON 13:49:15 Dec 28, 2012.
     JAVASCRIPT APPENDED BY WAYBACK MACHINE, COPYRIGHT INTERNET ARCHIVE.

     ALL OTHER CONTENT MAY ALSO BE PROTECTED BY COPYRIGHT (17 U.S.C.
     SECTION 108(a)(3)).
-->
</body></html>