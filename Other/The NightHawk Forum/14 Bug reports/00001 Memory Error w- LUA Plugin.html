<HTML><HEAD><META http-equiv="Content-Type" content="text/html; charset=UTF-8"><TITLE>Memory Error w/ LUA Plugin</TITLE></HEAD><BODY><TABLE width="100%" border="1"><TR><TH width="150">Author</TH><TH>Message</TH></TR><TR><TD valign="top" align="left"><B>CrazyGuy<BR></B>Administrator<BR>Full Member<BR> Offline<BR>Posts: 169<BR></TD><TD valign="top" align="left"><table width="100%" border="0"><tr><td valign="middle"><BR></TD><td valign="middle">Memory Error w/ LUA Plugin<BR>&#171; <B> on:</B> May 01, 2007, 10:28:12 PM &#187;</TD><td align="right" valign="bottom" height="20"></TD></TR></TABLE>HexHub version: 4.01 with firewall 1.03<BR>LUA Plugin: HexLua_5.1.2_plugin0.5<BR>Running scripts: BlackJack version 2.2 by CrazyGuy (debug version)<BR>After being idle for a few hours, the LUA plugin throws a memory error when typing in mainchat<BR>Timestamps included for clearity<BR>Mainchat:<BR>Quote[12:23:47] &lt;•BlackJack•&gt; I&#039;&#039;&#039;&#039;m ready for another game ! type bj_start<BR>[23:00:50] &lt;CrazyGuy&gt; test<BR>[23:00:50] &lt;•BlackJack•&gt; not enough memory<BR>[23:02:29] &lt;CrazyGuy&gt; hello<BR>[23:02:35] &lt;CrazyGuy&gt; no hello ?<BR>[23:02:37] &lt;CrazyGuy&gt; test<BR>[23:02:40] &lt;CrazyGuy&gt; weird<BR>[23:03:42] &lt;CrazyGuy&gt; [command] !bj_start<BR>[23:03:42] &lt;•BlackJack•&gt; CrazyGuy has joined the table.<BR>[23:03:42] &lt;•BlackJack•&gt; &nbsp;&nbsp;&nbsp;Welcome to BlackJack<BR>HexHub Logger file:<BR>Quote<BR>[01-05-2007 12:23:51] 127.&nbsp; 0.&nbsp; 0.&nbsp; 1:2559&nbsp;&nbsp;&nbsp;$MyINFO $ALL CrazyGuy<BR>[01-05-2007 12:56:23] 127.&nbsp; 0.&nbsp; 0.&nbsp; 1:2559&nbsp;&nbsp;&nbsp;$MyINFO $ALL CrazyGuy<BR>[01-05-2007 13:57:23] 127.&nbsp; 0.&nbsp; 0.&nbsp; 1:2559&nbsp;&nbsp;&nbsp;$MyINFO $ALL CrazyGuy<BR>[01-05-2007 14:58:23] 127.&nbsp; 0.&nbsp; 0.&nbsp; 1:2559&nbsp;&nbsp;&nbsp;$MyINFO $ALL CrazyGuy<BR>[01-05-2007 15:59:23] 127.&nbsp; 0.&nbsp; 0.&nbsp; 1:2559&nbsp;&nbsp;&nbsp;$MyINFO $ALL CrazyGuy<BR>[01-05-2007 16:51:14] 127.&nbsp; 0.&nbsp; 0.&nbsp; 1:2559&nbsp;&nbsp;&nbsp;$MyINFO $ALL CrazyGuy<BR>[01-05-2007 17:00:23] 127.&nbsp; 0.&nbsp; 0.&nbsp; 1:2559&nbsp;&nbsp;&nbsp;$MyINFO $ALL CrazyGuy<BR>[01-05-2007 17:25:48] 127.&nbsp; 0.&nbsp; 0.&nbsp; 1:2559&nbsp;&nbsp;&nbsp;$MyINFO $ALL CrazyGuy<BR>[01-05-2007 18:01:23] 127.&nbsp; 0.&nbsp; 0.&nbsp; 1:2559&nbsp;&nbsp;&nbsp;$MyINFO $ALL CrazyGuy<BR>[01-05-2007 19:02:23] 127.&nbsp; 0.&nbsp; 0.&nbsp; 1:2559&nbsp;&nbsp;&nbsp;$MyINFO $ALL CrazyGuy<BR>[01-05-2007 20:03:23] 127.&nbsp; 0.&nbsp; 0.&nbsp; 1:2559&nbsp;&nbsp;&nbsp;$MyINFO $ALL CrazyGuy<BR>[01-05-2007 21:04:23] 127.&nbsp; 0.&nbsp; 0.&nbsp; 1:2559&nbsp;&nbsp;&nbsp;$MyINFO $ALL CrazyGuy<BR>[01-05-2007 22:05:23] 127.&nbsp; 0.&nbsp; 0.&nbsp; 1:2559&nbsp;&nbsp;&nbsp;$MyINFO $ALL CrazyGuy<BR>[01-05-2007 23:00:50] 127.&nbsp; 0.&nbsp; 0.&nbsp; 1:2559&nbsp;&nbsp;&nbsp;&lt;CrazyGuy&gt; test|<BR>[01-05-2007 23:02:29] 127.&nbsp; 0.&nbsp; 0.&nbsp; 1:2559&nbsp;&nbsp;&nbsp;&lt;CrazyGuy&gt; hello|<BR>[01-05-2007 23:02:35] 127.&nbsp; 0.&nbsp; 0.&nbsp; 1:2559&nbsp;&nbsp;&nbsp;&lt;CrazyGuy&gt; no hello ?|<BR>[01-05-2007 23:02:37] 127.&nbsp; 0.&nbsp; 0.&nbsp; 1:2559&nbsp;&nbsp;&nbsp;&lt;CrazyGuy&gt; test|<BR>[01-05-2007 23:02:40] 127.&nbsp; 0.&nbsp; 0.&nbsp; 1:2559&nbsp;&nbsp;&nbsp;&lt;CrazyGuy&gt; weird|<BR>[01-05-2007 23:03:42] 127.&nbsp; 0.&nbsp; 0.&nbsp; 1:2559&nbsp;&nbsp;&nbsp;&lt;CrazyGuy&gt; !bj_start|<BR>BlackJack script Debug Logging:<BR>Quote<BR>[05/01/07 12:23:47] 328 : HexHub.SendToAll(&#039;&#039;&#039;&#039;&#039;&#039;&#039;&#039;&lt;&#039;&#039;&#039;&#039;&#039;&#039;&#039;&#039;..sBotName..&#039;&#039;&#039;&#039;&#039;&#039;&#039;&#039;&gt; I&#039;&#039;&#039;&#039;m ready for another game ! type &#039;&#039;&#039;&#039;&#039;&#039;&#039;&#039;..cmdStartGame..&#039;&#039;&#039;&#039;&#039;&#039;&#039;&#039;|&#039;&#039;&#039;&#039;&#039;&#039;&#039;&#039;)<BR>[05/01/07 12:23:47] 352 : return false<BR>[05/01/07 23:00:50] 93 : OnError = function(sError)<BR>[05/01/07 23:00:50] 95 : HexHub.SendToAll(&#039;&#039;&#039;&#039;&#039;&#039;&#039;&#039;&lt;&#039;&#039;&#039;&#039;&#039;&#039;&#039;&#039;..sBotName..&#039;&#039;&#039;&#039;&#039;&#039;&#039;&#039;&gt; &#039;&#039;&#039;&#039;&#039;&#039;&#039;&#039;..sError..&#039;&#039;&#039;&#039;&#039;&#039;&#039;&#039;|&#039;&#039;&#039;&#039;&#039;&#039;&#039;&#039;)<BR>[05/01/07 23:00:50] 98 : return 0<BR>[05/01/07 23:02:29] 252 : OnChatMessage = function(iUserId, sData)<BR>[05/01/07 23:02:29] 255 : local _,_,cmd = string.find(sData, &#039;&#039;&#039;&#039;&#039;&#039;&#039;&#039;%b&lt;&gt;%s(%S)&#039;&#039;&#039;&#039;&#039;&#039;&#039;&#039;)<BR>[05/01/07 23:02:29] 257 : if string.lower(cmd) == &#039;&#039;&#039;&#039;&#039;&#039;&#039;&#039;n&#039;&#039;&#039;&#039;&#039;&#039;&#039;&#039; and HexHub.NickFromId(iUserId) == tPlayers[iCurPlayer] then<BR>[05/01/07 23:02:29] 255 : return true<BR>[05/01/07 23:02:35] 252 : OnChatMessage = function(iUserId, sData)<BR>[05/01/07 23:02:35] 255 : local _,_,cmd = string.find(sData, &#039;&#039;&#039;&#039;&#039;&#039;&#039;&#039;%b&lt;&gt;%s(%S)&#039;&#039;&#039;&#039;&#039;&#039;&#039;&#039;)<BR>[05/01/07 23:02:35] 257 : if string.lower(cmd) == &#039;&#039;&#039;&#039;&#039;&#039;&#039;&#039;n&#039;&#039;&#039;&#039;&#039;&#039;&#039;&#039; and HexHub.NickFromId(iUserId) == tPlayers[iCurPlayer] then<BR>[05/01/07 23:02:35] 255 : return true<BR>[05/01/07 23:02:37] 252 : OnChatMessage = function(iUserId, sData)<BR>[05/01/07 23:02:37] 255 : local _,_,cmd = string.find(sData, &#039;&#039;&#039;&#039;&#039;&#039;&#039;&#039;%b&lt;&gt;%s(%S)&#039;&#039;&#039;&#039;&#039;&#039;&#039;&#039;)<BR>[05/01/07 23:02:37] 257 : if string.lower(cmd) == &#039;&#039;&#039;&#039;&#039;&#039;&#039;&#039;n&#039;&#039;&#039;&#039;&#039;&#039;&#039;&#039; and HexHub.NickFromId(iUserId) == tPlayers[iCurPlayer] then<BR>[05/01/07 23:02:37] 255 : return true<BR>[05/01/07 23:02:40] 252 : OnChatMessage = function(iUserId, sData)<BR>[05/01/07 23:02:40] 255 : local _,_,cmd = string.find(sData, &#039;&#039;&#039;&#039;&#039;&#039;&#039;&#039;%b&lt;&gt;%s(%S)&#039;&#039;&#039;&#039;&#039;&#039;&#039;&#039;)<BR>[05/01/07 23:02:40] 257 : if string.lower(cmd) == &#039;&#039;&#039;&#039;&#039;&#039;&#039;&#039;n&#039;&#039;&#039;&#039;&#039;&#039;&#039;&#039; and HexHub.NickFromId(iUserId) == tPlayers[iCurPlayer] then<BR>[05/01/07 23:02:40] 255 : return true<BR>[05/01/07 23:03:42] 252 : OnChatMessage = function(iUserId, sData)<BR>[05/01/07 23:03:42] 255 : local _,_,cmd = string.find(sData, &#039;&#039;&#039;&#039;&#039;&#039;&#039;&#039;%b&lt;&gt;%s(%S)&#039;&#039;&#039;&#039;&#039;&#039;&#039;&#039;)<BR>[05/01/07 23:03:42] 257 : if string.lower(cmd) == &#039;&#039;&#039;&#039;&#039;&#039;&#039;&#039;n&#039;&#039;&#039;&#039;&#039;&#039;&#039;&#039; and HexHub.NickFromId(iUserId) == tPlayers[iCurPlayer] then<BR>[05/01/07 23:03:42] 255 : return true<BR>[05/01/07 23:03:42] 166 : function OnRegisteredCommand(iCommandId, iUserId, sData, bIsPM)<BR>[05/01/07 23:03:42] 169 : if iCommandId == iCmdS then<BR>As the timestamps show, the first message in main (&lt;CrazyGuy&gt; test ) resulted in the error logged by the script<BR>Quote[05/01/07 23:00:50] 93 : OnError = function(sError)<BR>[05/01/07 23:00:50] 95 : HexHub.SendToAll(&#039;&#039;&#039;&#039;&#039;&#039;&#039;&#039;&lt;&#039;&#039;&#039;&#039;&#039;&#039;&#039;&#039;..sBotName..&#039;&#039;&#039;&#039;&#039;&#039;&#039;&#039;&gt; &#039;&#039;&#039;&#039;&#039;&#039;&#039;&#039;..sError..&#039;&#039;&#039;&#039;&#039;&#039;&#039;&#039;|&#039;&#039;&#039;&#039;&#039;&#039;&#039;&#039;)<BR>[05/01/07 23:00:50] 98 : return 0<BR>Instead of calling function OnChatMessage, the plugin calls function OnError<BR>For bluebear to follow up&nbsp; [/default/grin.gif]</TD></TR><TR><TD valign="top" align="left"><B>bluebear<BR></B>Developer<BR>Newbie<BR> Offline<BR>Posts: 6<BR></TD><TD valign="top" align="left"><table width="100%" border="0"><tr><td valign="middle"><BR></TD><td valign="middle">Re: Memory Error w/ LUA Plugin<BR>&#171; <B>Reply #1 on:</B> May 04, 2007, 11:23:53 PM &#187;</TD><td align="right" valign="bottom" height="20"></TD></TR></TABLE>I&#039;&#039;ve been running your test/debug script for about 12 hours now.<BR>I had no errors nor crash.<BR>Im running hexhub with Lua 5.1.2 plug 0.5 (debug version) with the visual studio debugger attached.<BR>The hexhub version is 4.02 and firewall is disabled. Im running it on both windows vista, and on XP SP2.<BR>So far i think your system simply ran out of memory, otherwise you would not get this error.<BR>In this weekend i&#039;&#039;ll release a version 0.6 that will stop the script if &quot;out of memory&quot; is returned by the OS.<BR>For now i will let the 2 instances of hexhub run with debugger attached for another 12 hours.<BR>And i will start 2 more instances using the same plugin as found on source forge as well to<BR>see if theres any difference.</TD></TR><TR><TD valign="top" align="left"><B>bluebear<BR></B>Developer<BR>Newbie<BR> Offline<BR>Posts: 6<BR></TD><TD valign="top" align="left"><table width="100%" border="0"><tr><td valign="middle"><BR></TD><td valign="middle">Re: Memory Error w/ LUA Plugin<BR>&#171; <B>Reply #2 on:</B> May 05, 2007, 08:56:45 AM &#187;</TD><td align="right" valign="bottom" height="20"></TD></TR></TABLE>Now i had this error in my debug version..<BR>Its not really a out of memory error, but the Lua garbage collector that is trying to use memory that has already been freed.</TD></TR><TR><TD valign="top" align="left"><B>CrazyGuy<BR></B>Administrator<BR>Full Member<BR> Offline<BR>Posts: 169<BR></TD><TD valign="top" align="left"><table width="100%" border="0"><tr><td valign="middle"><BR></TD><td valign="middle">Re: Memory Error w/ LUA Plugin<BR>&#171; <B>Reply #3 on:</B> May 05, 2007, 12:02:45 PM &#187;</TD><td align="right" valign="bottom" height="20"></TD></TR></TABLE>Well, good you found it cuz it&#039;&#039;s an annoying bug&nbsp; &nbsp;:P<BR>But now that you got it, it should be easy to fix&nbsp; [/default/grin.gif]</TD></TR><TR><TD valign="top" align="left"><B>Chucky<BR></B>Newbie<BR> Offline<BR>Posts: 10<BR></TD><TD valign="top" align="left"><table width="100%" border="0"><tr><td valign="middle"><BR></TD><td valign="middle">Re: Memory Error w/ LUA Plugin<BR>&#171; <B>Reply #4 on:</B> July 29, 2007, 11:34:25 AM &#187;</TD><td align="right" valign="bottom" height="20"></TD></TR></TABLE>Has it been fixed ?</TD></TR><TR><TD valign="top" align="left"><B>CrazyGuy<BR></B>Administrator<BR>Full Member<BR> Offline<BR>Posts: 169<BR></TD><TD valign="top" align="left"><table width="100%" border="0"><tr><td valign="middle"><BR></TD><td valign="middle">Re: Memory Error w/ LUA Plugin<BR>&#171; <B>Reply #5 on:</B> August 19, 2007, 11:46:27 PM &#187;</TD><td align="right" valign="bottom" height="20"></TD></TR></TABLE>afaik no new version has been released yet&nbsp; [/default/undecided.gif]</TD></TR><TR><TD valign="top" align="left"><B>Chucky<BR></B>Newbie<BR> Offline<BR>Posts: 10<BR></TD><TD valign="top" align="left"><table width="100%" border="0"><tr><td valign="middle"><BR></TD><td valign="middle">Re: Memory Error w/ LUA Plugin<BR>&#171; <B>Reply #6 on:</B> August 31, 2007, 09:37:35 AM &#187;</TD><td align="right" valign="bottom" height="20"></TD></TR></TABLE>I&#039;ve seen you guys, talking a lot about new lua scripts for Hex on HexHub admin&#039;s hub ....<BR>But i&#039;ve noticed that luaplugin as not been updated yet ...<BR>Am i missing something ?&nbsp; [/default/undecided.gif]</TD></TR><TR><TD valign="top" align="left"><B>CrazyGuy<BR></B>Administrator<BR>Full Member<BR> Offline<BR>Posts: 169<BR></TD><TD valign="top" align="left"><table width="100%" border="0"><tr><td valign="middle"><BR></TD><td valign="middle">Re: Memory Error w/ LUA Plugin<BR>&#171; <B>Reply #7 on:</B> September 01, 2007, 03:39:15 PM &#187;</TD><td align="right" valign="bottom" height="20"></TD></TR></TABLE>Nope don&#039;t think so. We&#039;re making the best with what we got right now&nbsp; [/default/wink.gif]</TD></TR></TABLE></BODY></HTML>