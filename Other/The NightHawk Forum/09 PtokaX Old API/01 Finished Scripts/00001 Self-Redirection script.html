<HTML><HEAD><META http-equiv="Content-Type" content="text/html; charset=UTF-8"><TITLE>Self-Redirection script</TITLE></HEAD><BODY><TABLE width="100%" border="1"><TR><TH width="150">Author</TH><TH>Message</TH></TR><TR><TD valign="top" align="left"><B>CrazyGuy<BR></B>Administrator<BR>Full Member<BR> Offline<BR>Posts: 169<BR></TD><TD valign="top" align="left"><table width="100%" border="0"><tr><td valign="middle"><BR></TD><td valign="middle">Self-Redirection script<BR>&#171; <B> on:</B> April 08, 2007, 11:37:19 PM &#187;</TD><td align="right" valign="bottom" height="20"></TD></TR></TABLE>Code:--[[<BR>HubJumper<BR>LUA 5.1.x<BR>A redirect-self script<BR>By CrazyGuy<BR>On request by Då®k][Wîzå®d™<BR>Last updated April 8th 2007<BR>]]--<BR>Quote&lt;Hub-Jumper&gt; Available commands:<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!redirhelp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-Shows this help file<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!addhub &lt;address:port&gt;&nbsp;&nbsp;&nbsp;-Add a hub to the list<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!delhub &lt;address:port&gt;&nbsp;&nbsp;&nbsp;-Delete a hub from the list<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!showhubs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-Shows all hubs in the list<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!jump &lt;address:port&gt;&nbsp;&nbsp;&nbsp;-Redirect yourself to the specified hub<BR>Attached the lua file :)<BR></TD></TR><TR><TD valign="top" align="left"><B>Då®k][Wîzå®d™<BR></B>Newbie<BR> Offline<BR>Posts: 6<BR></TD><TD valign="top" align="left"><table width="100%" border="0"><tr><td valign="middle"><BR></TD><td valign="middle">Re: Self-Redirection script<BR>&#171; <B>Reply #1 on:</B> April 09, 2007, 02:29:03 PM &#187;</TD><td align="right" valign="bottom" height="20"></TD></TR></TABLE>Nice Job CrazyGuy , really appreciate it&nbsp; [/default/wink.gif]</TD></TR><TR><TD valign="top" align="left"><B>CrazyGuy<BR></B>Administrator<BR>Full Member<BR> Offline<BR>Posts: 169<BR></TD><TD valign="top" align="left"><table width="100%" border="0"><tr><td valign="middle"><BR></TD><td valign="middle">Re: Self-Redirection script<BR>&#171; <B>Reply #2 on:</B> April 09, 2007, 02:33:41 PM &#187;</TD><td align="right" valign="bottom" height="20"></TD></TR></TABLE>You&#39;&#39;re welcome&nbsp; [/default/grin.gif]</TD></TR><TR><TD valign="top" align="left"><B>Då®k][Wîzå®d™<BR></B>Newbie<BR> Offline<BR>Posts: 6<BR></TD><TD valign="top" align="left"><table width="100%" border="0"><tr><td valign="middle"><BR></TD><td valign="middle">Re: Self-Redirection script<BR>&#171; <B>Reply #3 on:</B> April 22, 2007, 12:12:57 PM &#187;</TD><td align="right" valign="bottom" height="20"></TD></TR></TABLE>is it possible to add a !save comand , as you can add hubs ok but when restarting scripts or hub reboot the new hub is lost .</TD></TR><TR><TD valign="top" align="left"><B>Cêñoßy†ê<BR></B>Developer<BR>Newbie<BR> Offline<BR>Posts: 3<BR></TD><TD valign="top" align="left"><table width="100%" border="0"><tr><td valign="middle"><BR></TD><td valign="middle">Re: Self-Redirection script<BR>&#171; <B>Reply #4 on:</B> April 22, 2007, 06:57:22 PM &#187;</TD><td align="right" valign="bottom" height="20"></TD></TR></TABLE>Try this one [/default/wink.gif]<BR>Code:--[[<BR>HubJumper<BR>LUA 5.1.x<BR>A redirect-self script<BR>By CrazyGuy<BR>On request by Då®k][Wîzå®d™<BR>Last updated April 8th 2007<BR>* Saves addresses to own file (04/22/07), Cêñoßy†ê<BR>]]--</TD></TR><TR><TD valign="top" align="left"><B>CrazyGuy<BR></B>Administrator<BR>Full Member<BR> Offline<BR>Posts: 169<BR></TD><TD valign="top" align="left"><table width="100%" border="0"><tr><td valign="middle"><BR></TD><td valign="middle">Re: Self-Redirection script<BR>&#171; <B>Reply #5 on:</B> April 23, 2007, 12:36:24 AM &#187;</TD><td align="right" valign="bottom" height="20"></TD></TR></TABLE>Great work CenoByte&nbsp; [/default/grin.gif]</TD></TR><TR><TD valign="top" align="left"><B>Då®k][Wîzå®d™<BR></B>Newbie<BR> Offline<BR>Posts: 6<BR></TD><TD valign="top" align="left"><table width="100%" border="0"><tr><td valign="middle"><BR></TD><td valign="middle">Re: Self-Redirection script<BR>&#171; <B>Reply #6 on:</B> April 29, 2007, 02:17:17 PM &#187;</TD><td align="right" valign="bottom" height="20"></TD></TR></TABLE>Hmmm maybe its me but it doesnt seem to be saving to anywhere , sorry i just got round to trying it , i added another addy and after i restart scripts the last added hub is no longer there?</TD></TR><TR><TD valign="top" align="left"><B>CrazyGuy<BR></B>Administrator<BR>Full Member<BR> Offline<BR>Posts: 169<BR></TD><TD valign="top" align="left"><table width="100%" border="0"><tr><td valign="middle"><BR></TD><td valign="middle">Re: Self-Redirection script<BR>&#171; <B>Reply #7 on:</B> April 30, 2007, 01:30:22 PM &#187;</TD><td align="right" valign="bottom" height="20"></TD></TR></TABLE>Looking at CenoBytes script, he was almost there but forgot something eventually&nbsp; [/default/grin.gif]<BR>The functions to save a file are there, but no command or OnTimer / OnExit that uses them&nbsp; :P<BR>Also, I don&#039;&#039;t see something that loads the tables on startup </TD></TR><TR><TD valign="top" align="left"><B>Cêñoßy†ê<BR></B>Developer<BR>Newbie<BR> Offline<BR>Posts: 3<BR></TD><TD valign="top" align="left"><table width="100%" border="0"><tr><td valign="middle"><BR></TD><td valign="middle">Re: Self-Redirection script<BR>&#171; <B>Reply #8 on:</B> May 04, 2007, 02:18:01 PM &#187;</TD><td align="right" valign="bottom" height="20"></TD></TR></TABLE>Quote from: CrazyGuy on April 30, 2007, 01:30:22 PM<BR>Looking at CenoBytes script, he was almost there but forgot something eventually&nbsp; [/default/grin.gif]<BR>The functions to save a file are there, but no command or OnTimer / OnExit that uses them&nbsp; :P<BR>Also, I don&#039;&#039;&#039;&#039;t see something that loads the tables on startup<BR>Whups.. my bad.. heres new one [/default/wink.gif]<BR>Code:HubJumper<BR>LUA 5.1.x<BR>A redirect-self script<BR>By CrazyGuy<BR>On request by Då®k][Wîzå®d™<BR>Last updated April 8th 2007<BR>* Saves addresses to own file (04/22/07), Cêñoßy†ê<BR>* Changed Permission table&nbsp; (05/04/07), Cêñoßy†ê<BR>* Fixed file saving when restarting script&nbsp; (05/04/07), Cêñoßy†ê</TD></TR><TR><TD valign="top" align="left"><B>Då®k][Wîzå®d™<BR></B>Newbie<BR> Offline<BR>Posts: 6<BR></TD><TD valign="top" align="left"><table width="100%" border="0"><tr><td valign="middle"><BR></TD><td valign="middle">Re: Self-Redirection script<BR>&#171; <B>Reply #9 on:</B> May 07, 2007, 10:09:04 AM &#187;</TD><td align="right" valign="bottom" height="20"></TD></TR></TABLE>Thx guys it works gr8 now , here we go again&nbsp; [/default/wink.gif]<BR>is it possible first off<BR>to have all hubs shown on the RC&#039;&#039;s so that a user only has to right click , see the list of hubs and click the on they want instead of copy &amp; paste ?<BR>second<BR>i know you have done this script exactly as i have asked<BR>but it it also possible to use the RC&#039;&#039;s to redirect self and also stay in the main hub running the redirect script ?<BR>either way thx for all your hard work&nbsp; [/default/grin.gif]</TD></TR><TR><TD valign="top" align="left"><B>CrazyGuy<BR></B>Administrator<BR>Full Member<BR> Offline<BR>Posts: 169<BR></TD><TD valign="top" align="left"><table width="100%" border="0"><tr><td valign="middle"><BR></TD><td valign="middle">Re: Self-Redirection script<BR>&#171; <B>Reply #10 on:</B> May 28, 2007, 01:10:40 PM &#187;</TD><td align="right" valign="bottom" height="20"></TD></TR></TABLE>Quote from: Då®k][Wîzå®d™ on May 07, 2007, 10:09:04 AM<BR>Thx guys it works gr8 now , here we go again&nbsp; [/default/wink.gif]<BR>is it possible first off<BR>to have all hubs shown on the RC&#039;&#039;s so that a user only has to right click , see the list of hubs and click the on they want instead of copy &amp; paste ?<BR>second<BR>i know you have done this script exactly as i have asked<BR>but it it also possible to use the RC&#039;&#039;s to redirect self and also stay in the main hub running the redirect script ?<BR>either way thx for all your hard work&nbsp; [/default/grin.gif]<BR>While testing, I haven&#039;t found a working way to have a user stay in the current hub AND open a new hub window with the new hub from the redirect tables.<BR>But, I have added that hub addresses will be send to UserCommands so they are simply clickable.<BR>Everytime a hub is added or deleted from the table however, all UserCommands have to be resend to all users by the script.<BR>It works, but it might cause quite some data flow in a big hub when the rd table is big as well<BR>Anyways, here&#039;s the script<BR>Code:--[[<BR>HubJumper<BR>LUA 5.1.x<BR>A redirect-self script<BR>By CrazyGuy<BR>On request by Då®k][Wîzå®d™<BR>Last updated April 8th 2007<BR>* Saves addresses to own file (04/22/07), Cêñoßy†ê<BR>* Changed Permission table&nbsp; (05/04/07), Cêñoßy†ê<BR>* Fixed file saving when restarting script&nbsp; (05/04/07), Cêñoßy†ê<BR>]]--<BR>sBotname = &quot;Hub-Jumper&quot;<BR>sFile = &quot;Redirect.tbl&quot;<BR>cmdAddHub = &quot;addhub&quot;<BR>cmdDelHub = &quot;delhub&quot;<BR>cmdShowHubs = &quot;showhubs&quot;<BR>cmdHelp = &quot;redirhelp&quot;<BR>cmdRD = &quot;jump&quot;<BR>tRDHubs = {}<BR>local f,e = io.open(sFile, &quot;a+&quot; ) if f then f:write(&quot;&quot; ) f:close() end<BR>tPermissions = {<BR>[0] = {<BR>[&quot;add_del&quot;] = 1,-- use 1 for allowed, 0 for not allowed<BR>[&quot;show&quot;] = 1,<BR>[&quot;rd&quot;] = 0,<BR>},<BR>[1] = {<BR>[&quot;add_del&quot;] = 1,-- use 1 for allowed, 0 for not allowed<BR>[&quot;show&quot;] = 1,<BR>[&quot;rd&quot;] = 1,<BR>},<BR>[2] = {<BR>[&quot;add_del&quot;] = 1,-- use 1 for allowed, 0 for not allowed<BR>[&quot;show&quot;] = 1,<BR>[&quot;rd&quot;] = 1,<BR>},<BR>[3] = {<BR>[&quot;add_del&quot;] = 0,-- use 1 for allowed, 0 for not allowed<BR>[&quot;show&quot;] = 1,<BR>[&quot;rd&quot;] = 1,<BR>},<BR>[4] = {<BR>[&quot;add_del&quot;] = 0,-- use 1 for allowed, 0 for not allowed<BR>[&quot;show&quot;] = 1,<BR>[&quot;rd&quot;] = 1,<BR>},<BR>[5] = {<BR>[&quot;add_del&quot;] = 1,-- use 1 for allowed, 0 for not allowed<BR>[&quot;show&quot;] = 1,<BR>[&quot;rd&quot;] = 0,<BR>},<BR>[-1] = {<BR>[&quot;add_del&quot;] = 0,-- use 1 for allowed, 0 for not allowed<BR>[&quot;show&quot;] = 1,<BR>[&quot;rd&quot;] = 1,<BR>},<BR>}<BR>tCMD = {<BR>[cmdHelp] = function(sNick,iProf,sArg)<BR>local sHelp = &quot;Available commands:\n\n\t\t!&quot;..cmdHelp..&quot;\t\t\t-Shows this help file\n&quot;<BR>if tPermissions[iProf].add_del == 1 then<BR>sHelp = sHelp..&quot;\n\t\t!&quot;..cmdAddHub..&quot; &lt;address:port&gt;\t-Add a hub to the list\n&quot;<BR>..&quot;\t\t!&quot;..cmdDelHub..&quot; &lt;address:port&gt;\t-Delete a hub from the list\n&quot;<BR>end<BR>if tPermissions[iProf].show == 1 then<BR>sHelp = sHelp..&quot;\n\t\t!&quot;..cmdShowHubs..&quot;\t\t-Shows all hubs in the list\n&quot;<BR>end<BR>if tPermissions[iProf].rd == 1 then<BR>sHelp = sHelp..&quot;\n\t\t!&quot;..cmdRD..&quot; &lt;address:port&gt;\t-Redirect yourself to the specified hub\n&quot;<BR>end<BR>return sHelp<BR>end,<BR>[cmdRD] = function(sNick,iProf,sArg)<BR>if sArg then<BR>if tPermissions[iProf].rd == 1 then<BR>return 1<BR>else<BR>return &quot;You are not allowed to use this command&quot;<BR>end<BR>else<BR>return &quot;Please specify an address -&gt; !&quot;..cmdRD..&quot; &lt;address:port&gt;&quot;<BR>end<BR>end,<BR>[cmdShowHubs] = function(sNick,iProf,sArg)<BR>if tPermissions[iProf].show == 1 then<BR>local sHubs = &quot;Current hubs to redirect to:\n\n&quot;<BR>for k in pairs(tRDHubs) do<BR>sHubs = sHubs..&quot;\t\t&quot;..tRDHubs[k]..&quot;\n&quot;<BR>end<BR>return sHubs<BR>else<BR>return &quot;You are not allowed to use this command&quot;<BR>end<BR>end,<BR>[cmdAddHub] = function(sNick,iProf,sArg)<BR>if sArg then-- if address is specified<BR>if tPermissions[iProf].add_del == 1 then<BR>table.insert(tRDHubs,sArg)-- add hub<BR>SaveToFile(sFile,tRDHubs,&quot;tRDHubs&quot;)<BR>local tAllUsers = frmHub:GetOnlineUsers()<BR>for _,k in pairs(tAllUsers) do<BR>SendUserCommands(k.sName)<BR>end<BR>return sArg..&quot; has been added to the list&quot;<BR>else<BR>return &quot;You are not allowed to use this command&quot;<BR>end<BR>else<BR>return &quot;Please specify an address -&gt; !&quot;..cmdAddHub..&quot; &lt;address:port&gt;&quot;<BR>end<BR>end,<BR>[cmdDelHub] = function(sNick,iProf,sArg)<BR>if sArg then<BR>if tPermissions[iProf].add_del == 1 then<BR>for k in pairs(tRDHubs) do<BR>if tRDHubs[k] == sArg then<BR>table.remove(tRDHubs, k)-- remove hub<BR>SaveToFile(sFile,tRDHubs,&quot;tRDHubs&quot;)<BR>break<BR>end<BR>end<BR>local tAllUsers = frmHub:GetOnlineUsers()<BR>for _,k in pairs(tAllUsers) do<BR>SendUserCommands(k.sName)<BR>end<BR>return sArg..&quot; has been removed from the list&quot;<BR>else<BR>return &quot;You are not allowed to use this command&quot;<BR>end<BR>else<BR>return &quot;Please specify an address -&gt; !&quot;..cmdDelHub..&quot; &lt;address:port&gt;&quot;<BR>end<BR>end,<BR>}<BR>Main = function()<BR>dofile(sFile)<BR>frmHub:RegBot(sBotname)<BR>end<BR>OnExit = function()<BR>SaveToFile(sFile,tRDHubs,&quot;tRDHubs&quot;)<BR>end<BR>ChatArrival = function(User,Data)<BR>local _,_,cmd,sArgs = string.find(Data, &quot;%b&lt;&gt;%s%p(%S+)%s(.*)|&quot;)<BR>if sArgs then<BR>if tCMD[cmd] then<BR>local sReturn = tCMD[cmd](User.sName,User.iProfile,sArgs)<BR>if sReturn == 1 then<BR>-- user will be redirected<BR>User:SendData(sBotname, &quot;You will now be redirected to &quot;..sArgs)<BR>User:Redirect(sArgs, &quot;You have choosen to be redirected to this hub. Enjoy your stay there&quot;)<BR>else<BR>-- return the message<BR>User:SendData(sBotname,sReturn)<BR>end<BR>return 1<BR>end<BR>else<BR>-- no arguments, could be show or help command<BR>local _,_,sCmd = string.find(Data, &quot;%b&lt;&gt;%s%p(%S+)|&quot;)<BR>if tCMD[sCmd] then<BR>User:SendData(sBotname, tCMD[sCmd](User.sName,User.iProfile,nil))<BR>return 1<BR>end<BR>end<BR>end<BR>ToArrival = function(User,Data)<BR>local _,_,cmd,sArgs = string.find(Data, &quot;%b&lt;&gt;%s%p(%S+)%s(.*)|&quot;)<BR>if sArgs then<BR>if tCMD[cmd] then<BR>local sReturn = tCMD[cmd](User.sName,User.iProfile,sArgs)<BR>if sReturn == 1 then<BR>-- user will be redirected<BR>User:SendPM(sBotname, &quot;You will now be redirected to &quot;..sArgs)<BR>User:Redirect(sArgs, &quot;You have choosen to be redirected to this hub. Enjoy your stay there&quot;)<BR>else<BR>-- return the message<BR>User:SendData(sBotname,sReturn)<BR>end<BR>return 1<BR>end<BR>else<BR>-- no arguments, could be show or help command<BR>local _,_,sCmd = string.find(Data, &quot;%b&lt;&gt;%s%p(%S+)|&quot;)<BR>if tCMD[sCmd] then<BR>User:SendPM(sBotname, tCMD[sCmd](User.sName,User.iProfile,nil))<BR>return 1<BR>end<BR>end<BR>end<BR>NewUserConnected = function(User)<BR>SendUserCommands(User.sName)<BR>end<BR>OpConnected = NewUserConnected<BR>SendUserCommands = function(sNick)<BR>local sMenu = frmHub:GetHubName()<BR>local User = GetItemByName(sNick)<BR>User:SendData(&quot;$UserCommand 255 9|&quot;)<BR>User:SendData(&quot;$UserCommand 1 3 &quot;..sMenu..&quot;\\&quot;..sBotname..&quot;\\Help$&lt;%[mynick]&gt; !&quot;..cmdHelp..&quot;&#38;#124;|&quot;)<BR>if tPermissions[User.iProfile].add_del == 1 then<BR>User:SendData(&quot;$UserCommand 0 3 &#38;#124;|&quot;)<BR>User:SendData(&quot;$UserCommand 1 3 &quot;..sMenu..&quot;\\&quot;..sBotname..&quot;\\Add Hub$&lt;%[mynick]&gt; !&quot;..cmdAddHub..&quot; %[line:Address]&#38;#124;|&quot;)<BR>User:SendData(&quot;$UserCommand 1 3 &quot;..sMenu..&quot;\\&quot;..sBotname..&quot;\\Delete Hub$&lt;%[mynick]&gt; !&quot;..cmdDelHub..&quot; %[line:Address]&#38;#124;|&quot;)<BR>end<BR>if tPermissions[User.iProfile].show == 1 then<BR>User:SendData(&quot;$UserCommand 0 3 &#38;#124;|&quot;)<BR>User:SendData(&quot;$UserCommand 1 3 &quot;..sMenu..&quot;\\&quot;..sBotname..&quot;\\Show Hubs$&lt;%[mynick]&gt; !&quot;..cmdShowHubs..&quot;&#38;#124;|&quot;)<BR>end<BR>if tPermissions[User.iProfile].rd == 1 then<BR>User:SendData(&quot;$UserCommand 0 3 &#38;#124;|&quot;)<BR>User:SendData(&quot;$UserCommand 1 3 &quot;..sMenu..&quot;\\&quot;..sBotname..&quot;\\Redirect Self$&lt;%[mynick]&gt; !&quot;..cmdRD..&quot; %[line:Address]&#38;#124;|&quot;)<BR>for k in pairs(tRDHubs) do<BR>User:SendData(&quot;$UserCommand 1 3 &quot;..sMenu..&quot;\\&quot;..sBotname..&quot;\\Redirect Self to &quot;..tRDHubs[k]..&quot;$&lt;%[mynick]&gt; !&quot;..cmdRD..&quot; &quot;..tRDHubs[k]..&quot;&#38;#124;|&quot;)<BR>end<BR>end<BR>end<BR>Serialize = function(tTable,sTableName,hFile,sTab)<BR>sTab = sTab or &quot;&quot;<BR>hFile:write(sTab..sTableName..&quot; = {\n&quot;)<BR>for key,value in pairs(tTable) do<BR>if (type(value) ~= &quot;function&quot;) then<BR>local sKey = (type(key) == &quot;string&quot;) and string.format(&quot;[%q]&quot;,key) or string.format(&quot;[%d]&quot;,key)<BR>if(type(value) == &quot;table&quot;) then<BR>Serialize(value,sKey,hFile,sTab..&quot;\t&quot;)<BR>else<BR>local sValue = (type(value) == &quot;string&quot;) and string.format(&quot;%q&quot;,value) or tostring(value)<BR>hFile:write(sTab..&quot;\t&quot;..sKey..&quot; = &quot;..sValue)<BR>end<BR>hFile:write(&quot;,\n&quot;)<BR>end<BR>end<BR>hFile:write(sTab..&quot;}&quot;)<BR>end<BR>SaveToFile = function(file, table, tablename)<BR>local handle = io.open(file,&quot;w&quot;)<BR>Serialize(table,tablename,handle)<BR>&nbsp; &nbsp;handle:close()<BR>end<BR>Greetz, CG ;-)</TD></TR><TR><TD valign="top" align="left"><B>Då®k][Wîzå®d™<BR></B>Newbie<BR> Offline<BR>Posts: 6<BR></TD><TD valign="top" align="left"><table width="100%" border="0"><tr><td valign="middle"><BR></TD><td valign="middle">Re: Self-Redirection script<BR>&#171; <B>Reply #11 on:</B> June 08, 2007, 05:33:02 PM &#187;</TD><td align="right" valign="bottom" height="20"></TD></TR></TABLE>nice1 CG&nbsp; [/default/wink.gif]</TD></TR></TABLE></BODY></HTML>